# Working on Snort Version (2.9.16 FLOW RULES DO NOT WORK ERROR IN SNORT) - 2.9.16.1 - 2.9.17.0 - 2.8.18.0 - 2.9.19.0 - 2.9.20.0
# Created by Networkforensic.dk 
#
#-------------
# LOCAL RULES
#-------------
#
#
# CoboltStrike - SIGS number range: 5000001 - 5001000
alert tcp $HOME_NET any -> $EXTERNAL_NET 8080 (msg:"NF - Trojan CoboltStrike - NO ALERT"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"/lsass"; http_uri; flowbits:set,NF-CoboltStrike; flowbits:noalert; reference:url,networkforensic.dk; metadata:29062022; classtype:trojan-activity; sid:5000001; rev:1;)
alert tcp $EXTERNAL_NET 8080 -> $HOME_NET 1024: (msg:"NF - Trojan CoboltStrike"; flow:from_server,established; content:"|20 49 4f 2e 4d 65 6d 6f 72 79 53 74 72 65 61 6d|"; flowbits:isset,NF-CoboltStrike; reference:url,networkforensic.dk; metadata:29062022; classtype:trojan-activity; sid:5000002; rev:1;)
#
#
# Bumblebee Malware Downloader - IceID C2 Post traffic - SIGS number range: 5001001 - 5002000
#alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"NF - Bumblebee malware downloader certificate - Some-State"; flow:to_client,established; ssl_state:server_hello; content:"|53 6f 6d 65 2d 53 74 61 74 65|"; reference:url,networkforensic.dk; metadata:08122020; classtype:misc-activity; sid:5001001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Trojan IceID C2 Post traffic - Client Helo - Possible domain match - NO ALERT"; flow:to_server,established; ssl_state:client_hello; pcre:"/[a-z]{6,15}\.(com|site|pro|eu)/i"; flowbits:set,NF-IceID; flowbits:noalert; reference:url,networkforensic.dk; metadata:20082022; classtype:bad-unknown; sid:5001002; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET 1024: (msg:"NF - Trojan IceID C2 Post traffic - Bumblebee"; flow:to_client,established; ssl_state:server_hello; Content:"localhost"; content:"Some-State"; content:"Internet Widgits Pty Ltd"; flowbits:isset,NF-IceID; reference:url,networkforensic.dk; metadata:20082022; classtype:trojan-activity; sid:5001003; rev:1;)
#
#
# NF POLICY - SIGS number range: 5002001 - 5003000
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Hamachi VPN update check"; flow:established,to_server; Content:"versioncheck_hamachi.asp"; http_uri; reference:url,secure.logmein.com/products/hamachi/; reference:url,networkforensic.dk; metadata:26092014; classtype:policy-violation; sid:5002001; rev:1;)
alert udp any any -> any 53 (msg:"NF - DNS Request to Hamachi VPN Gateway - hamachi-dc.logmein-gateway.com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0a 68 61 6d 61 63 68 69 2d 64 63 0f 6c 6f 67 6d 65 69 6e 2d 67 61 74 65 77 61 79 03 63 6f 6d 00 00 01 00 01|"; distance:0; reference:url,secure.logmein.com/products/hamachi/; reference:url,networkforensic.dk; metadata:26092014; classtype:policy-violation; sid:5002002; rev:1;)
alert tcp $HOME_NET any -> [64.34.106.33,64.94.18.67,64.74.103.71] 12975 (msg:"NF - POLICY - Outbound Hamachi VPN Connection Attempt"; flags:S,12; detection_filter:track by_src, count 1, seconds 120; reference:url,secure.logmein.com/products/hamachi/; reference:url,networkforensic.dk; metadata:26092014; classtype:policy-violation; sid:5002003; rev:1;)
alert tcp [216.117.2.180,198.143.173.176,198.143.173.177,198.143.173.178,198.143.173.179,198.143.173.180,198.143.173.181,198.143.173.182,198.143.173.183,198.143.173.184,198.143.173.185,198.143.173.186,198.143.173.187,198.143.173.188,198.143.173.189,198.143.173.190] any -> $HOME_NET any (msg:"NF - SSLSONAR H.D.More Scanning - TCP Scan Established - Vulnerability scanning of your network"; flow:to_server,established; detection_filter:track by_src, count 2, seconds 30; reference:url,networkforensic.dk; metadata:26092014; classtype:network-scan; sid:5002004; rev:2;)
alert tcp [64.20.227.132,64.20.227.133,64.20.227.139] any -> $HOME_NET any (msg:"NF - Policy - anti-hacker-alliance ore mxtoolbox.com - Footprinting mail systems"; flow:established; detection_filter:track by_src, count 3, seconds 5; reference:url,networkforensic.dk; classtype:network-scan; metadata:20032015; sid:5002005; rev:1;)
alert udp $HOME_NET 514 -> $EXTERNAL_NET 514 (msg:"NF - POLICY - Unencrypted SYSLOG message detected - Something is not complient": content:"|87 71|"; reference:url,networkforensic.dk; metadata:11092015; classtype:policy-violation; sid:5002010; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - POLICY - Sonos firmware update"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/firmware/"; nocase; http_uri; content:"update-firmware.sonos.com"; nocase; http_header; reference:url,networkforensic.dk; metadata:26092015; classtype:policy-violation; sid:5002011; rev:1;)
alert tcp [209.126.230.70,209.126.230.71,209.126.230.72,209.126.230.73,209.126.230.74,209.126.230.75,209.126.230.76,209.126.230.77,209.126.230.78] any -> $HOME_NET any (msg:"NF - POLICY - Errata Security - offensive security - TCP Scan"; detection_filter:track by_src, count 1, seconds 1; reference:url,networkforensic.dk; metadata:24052016; classtype:network-scan; sid:5002012; rev:1;)
alert udp [209.126.230.70,209.126.230.71,209.126.230.72,209.126.230.73,209.126.230.74,209.126.230.75,209.126.230.76,209.126.230.77,209.126.230.78] any -> $HOME_NET any (msg:"NF - POLICY - Errata Security - offensive security - UDP Scan"; detection_filter:track by_src, count 1, seconds 1; reference:url,networkforensic.dk; metadata:24052016; classtype:network-scan; sid:5002013; rev:1;)
alert udp $EXTERNAL_NET 553 -> $HOME_NET 50000: (msg:"NF - POLICY - Hide my ass - Anonymous VPN Service in use"; dsize:110<>160; content:"|48 4d 41 20 50 72 6f 20 56 50 4e|"; depth:156; detection_filter:track by_src, count 6, seconds 1; reference:url,networkforensic.dk; metadata:18072016; classtype:policy-violation; sid:5002017; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET !3389 (msg:"NF - POLICY - Remote Desktop connection request on non-standard port"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|e0 00 00 00 00 00|"; offset:5; depth:6; content:"Cookie|3a| mstshash="; fast_pattern; reference:url,networkforensic.dk; classtype:policy-violation; metadata:12112017; sid:5002018; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - POLICY DNS Query to a *.ngrok tunnel domain - ngrok.com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|ngrok|03|com|00|"; nocase; reference:url,networkforensic.dk; metadata:30042018; classtype:policy-violation; sid:5002019; rev:2;)
alert udp $HOME_NET any -> any 53 (msg:"NF - POLICY DNS Query to a *.ngrok tunnel domain - ngrok.io"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|ngrok|02|io|00|";  nocase; reference:url,networkforensic.dk; metadata:30042018; classtype:policy-violation; sid:5002020; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Microsoft Excell making outbound Connections";  flow:established,to_server; content:"User-Agent|3a 20|Microsoft Office Protocol Discovery"; nocase; http_header; reference:url,www.malware-traffic-analysis.net/2018/05/25/index.html; metadata:26052018; classtype:policy-violation; sid:5002021; rev:1;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"NF - POLICY - Outbound SMB - Connection attempt"; flags:S; reference:url,networkforensic.dk; metadata:26102018; classtype:policy-violation; sid:5002022; rev:1;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"NF - POLICY - Outbound SMB Connection established"; flow:to_server,established; reference:url,networkforensic.dk; metadata:26102018; classtype:policy-violation; sid:5002023; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - Covert iodine tunnel request"; content:"|01 00 00 01 00 00 00 00 00 01|"; offset:2; depth:10; content:"|00 00 29 10 00 00 00 80 00 00 00|"; detection_filter:track by_src, count 1, seconds 300; metadata:07122014; reference:url,networkforensic.dk; classtype:policy-violation; sid:5002024; rev:1;)
alert udp $HOME_NET 53 -> $EXTERNAL_NET any (msg:"NF - POLICY - Covert iodine tunnel response"; content:"|84 00 00 01 00 01 00 00 00 00|"; offset:2; depth:10; content:"|00 00 0a 00 01|"; detection_filter:track by_src, count 1, seconds 300; metadata:07122014; reference:url,networkforensic.dk; classtype:policy-violation; sid:5002025; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - PROXY nstx dns tunnel outbound to server"; content:"cT"; offset:12; depth:3; content:"|00 10 00 01 00 00 29 08|"; within:255; metadata:07122014; reference:url,networkforensic.dk; classtype:policy-violation; sid:5002026; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - POLICY - Malicious DNS TXT Response Contains DNSCAT - DNS Tunnelling "; content:"|00 10 00 01 c0 0c|"; content:"dnscat"; nocase; detection_filter:track by_src, count 1000, seconds 5; reference:url,networkforensic.dk; reference:url,www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-5.html; metadata:11072015; classtype:policy-violation; sid:5002027; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - POLICY - Malicious DNS TXT Response - DNSCAT2 DNS Tunnelling"; content:"|00 10 00 01|"; pcre:"/\d{4}.01.\d{4}.[a-g0-9]{4}.[a-g]{1}[0-9]{3}.0000/i"; detection_filter:track by_dst, count 1000, seconds 5; reference:url,networkforensic.dk; reference:url,www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-5.html; metadata:11072015; classtype:policy-violation; sid:5002028; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - POLICY Possible Innuendo Covert DNS CnC Channel TXT Request"; content:"|01 00 00 01 00 00 00 00 00 01 3b|A"; depth:12; offset:2; fast_pattern; pcre:"/^[A-Z2-7]{57}A[^\x00]+/R"; content:"|00 00 10|"; within:3; reference:url,networkforensic.dk; metadata:11092016; classtype:policy-violation; sid:5002029; rev:1;)
alert udp any 53 -> $HOME_NET any (msg:"NF - POLICY Possible Innuendo Covert DNS CnC Channel TXT Response"; content:"|00 01 00 01 00 00 00 01 3b|A"; depth:10; offset:4; fast_pattern; pcre:"/^[A-Z2-7]{57}A[^\x00]+/R"; content:"|00 00 10|"; within:3; content:"|00 01|"; distance:4; within:4; content:"|00 35 34|"; distance:0; pcre:"/^[A-Za-z0-9+/=]{52}/R"; content:!"v=spf"; reference:url,networkforensic.dk; metadata:11092016; classtype:policy-violation; sid:5002030; rev:1;)
alert udp $EXTERNAL_NET 53 -> !$SMTP_SERVERS any (msg:"NF - POLICY - DNS TXT Response - Not to mail-servers"; content:"|00 10 00 01 c0 0c|"; content:!"|70 75 73 68 05 61 70 70 6C 65 03 63 6F 6D|"; content:!"aaplcache"; reference:url,networkforensic.dk; metadata:16062017; classtype:policy-violation; sid:5002031; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - Tripfile - Canarytokens domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/[a-z0-9]{24}\x0Ccanarytokens\x03com/i"; reference:url,networkforensic.dk; metadata:04022016; classtype:policy-violation; sid:5002032; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Generic POST rule on PORT 443"; flow:to_server,established; content:"POST"; depth:4; nocase; http_method; reference:url,networkforensic.dk; metadata:21052016; classtype:policy-violation; sid:5002033; rev:1;)
alert udp $EXTERNAL_NET 1024: -> $HOME_NET 1024: (msg:"NF - POLICY - F-Secure Freedom VPN client running"; dsize:500<>1242; content:"Freedome Clients"; reference:url,networkforensic.dk; metadata:10012021; classtype:policy-violation; sid:5002034; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - POLICY - freedome-vpn.net - Proxy vpn service"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|freedome-vpn|03|net"; nocase; reference:url,networkforensic.dk; metadata:10012021; classtype:policy-violation; sid:5002035; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - IOC - POLICY DNS - Hola proxy service - perr.hola.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|perr|04|hola|03|org"; nocase; reference:url,networkforensic.dk; metadata:05032022; classtype:policy-violation; sid:5002036; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - IOC - POLICY DNS - Hola proxy service - proxyjs.luminatinet.com - Proxy service"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|proxyjs|0b|luminatinet|03|com"; nocase; reference:url,networkforensic.dk; metadata:05032022; classtype:policy-violation; sid:5002037; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Hola Browser vpn detected - Client";  flow:to_server,established; ssl_state:client_hello; content:"client.hola.org"; reference:url,networkforensic.dk; metadata:05032022; classtype:misc-activity; sid:5002038; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Hola Browser vpn detected - VPN";  flow:to_server,established; ssl_state:client_hello; content:"h-vpn.org"; reference:url,networkforensic.dk; metadata:05032022; classtype:misc-activity; sid:5002039; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Hola Browser vpn detected - Extension";  flow:to_server,established; ssl_state:client_hello; content:"holavpnextension.com"; reference:url,networkforensic.dk; metadata:05032022; classtype:misc-activity; sid:5002040; rev:1;)
#
# Flux distributed bitcoin mining of different currencies
alert udp $HOME_NET any -> any 53 (msg:"NF - Distributed Bitcoin Mining domain - flux.cruxpool.com - check endpoints"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|flux|08|cruxpool|03|com"; nocase; reference:url,www.cruxpool.com; reference:url,networkforensic.dk; metadata:27092022; classtype:policy-violation; sid:5002041; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Distributed Bitcoin Mining domain - flux-eu.cruxpool.com - check endpoints"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|flux-eu|08|cruxpool|03|com"; nocase; reference:url,www.cruxpool.com; reference:url,networkforensic.dk; metadata:27092022; classtype:policy-violation; sid:5002042; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Distributed Bitcoin Mining domain - flux-us.cruxpool.com - check endpoints"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|flux-us|08|cruxpool|03|com"; nocase; reference:url,www.cruxpool.com; reference:url,networkforensic.dk; metadata:27092022; classtype:policy-violation; sid:5002043; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Distributed Bitcoin Mining domain - flux-asia.cruxpool.com - check endpoints"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|09|flux-asia|08|cruxpool|03|com"; nocase; reference:url,www.cruxpool.com; reference:url,networkforensic.dk; metadata:27092022; classtype:policy-violation; sid:5002044; rev:1;)
#
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Kali linux updating"; flow:from_client,established; detection_filter:track by_src, count 4, seconds 2; content:"GET"; depth:3; nocase; http_method; uricontent:"/kali/pool/main/"; nocase; reference:url,networkforensic.dk meadata:11112022; classtype:trojan-activity; sid:5002045; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - POLICY - Net.TCP Port Sharing Service in use - Check IP ore domain in URL"; flow:established,to_server; dsize:<50; content:"|00 01 00 01 02 02|"; content:"net.tcp://"; reference:url,networkforensic.dk; metadata:27022023; classtype:bad-unknown; sid:5002046; rev:1;)
#
#
# NF Malware - SIGS number range: 5003001 - 5004000
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET any (msg:"NF - Flawed Ammyy RAT CC Conection - NO ALERT"; flow:established,to_server; content:"|00 00 00 69 64 3d|"; depth:10; content:"|26 6f 73 3d|"; distance:0; within:30; content:"|26 70 72 69 76 3d|"; distance:0; within:20; content:"|26 63 72 65 64 3d|"; distance:0; within:20; content:"|26 70 63 6e 61 6d 65 3d|"; distance:0; content:"|26 61 76 6e 61 6d 65 3d|"; distance:0; content:"|26 62 75 69 6c 64 5f 74 69 6d 65 3d|"; distance:0; fast_pattern; content:"|26 63 61 72 64 3d|"; flowbits:set,NF-FAR; flowbits:noalert; distance:0; reference:url,networkforensic.dk; metadata:02122018; classtype:trojan-activity; sid:5003049; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1023:  (msg:"NF - Flawed Ammyy RAT 1 Byte C&C Conection Detected"; dsize:1; content:"|0c|"; flow:established,from_server; flags:PA; flowbits:isset,NF-FAR; reference:url,networkforensic.dk; metadata:02122018; classtype:trojan-activity; sid:5003050; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - TROJAN Socks5systemz Checkin"; flow:to_server,established; content:"GET"; depth:3; http_method; pcre:"/\/gate.php\?client_id\=[a-fA-F0-9]{32}\&connected\=1\&server\_port\=[0-9]{1,5}\&debug=[0-9]{1}/iU"; reference:url,networkforensic.dk; reference:url,fortiguard.com/encyclopedia/botnet/7629851; reference:url,malware-traffic-analysis.net/2018/12/07/index2.html; metadata:10122018; classtype:trojan-activity; sid:5003051; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NanoCore Trojan C2 - Connection setup detected"; flags:PA; flow:to_server,established; dsize:12<>75; content:"|40 00 00 00|"; depth:4; flowbits:set,NF-Nano; flowbits:noalert; reference:url,networkforensic.dk; metadata:08012019; classtype:policy-violation; sid:5003052; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NanoCore Trojan C2 - Traffic detected"; flags:PA; flow:to_server,established; content:"|08 00 00 00|"; depth:4; detection_filter:track by_dst, count 20, seconds 2; flowbits:isset,NF-Nano; reference:url,networkforensic.dk; metadata:08012019; classtype:policy-violation; sid:5003053; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Spelevo EK - POST Compromise Data Dump"; flow:to_server,established; content:"POST"; depth:4; http_method; pcre:"/\/?s=[a-z0-9]{32}mf/U"; reference:url,networkforensic.dk; metadata:24032019; classtype:trojan-activity; sid:5003054; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,2100,3535] (msg:"NF - Qbot Trojan variant FTP data Exfil"; flow:established,to_server; content:"STOR artic"; fast_pattern; content:"e_"; distance:1; within:2; pcre:"/^[a-z]{6}\d{6}_1[45]\d{8}\.zip\r?\n/R"; reference:url,networkforensic.dk; metadata:19042019; classtype:trojan-activity; sid:5003055; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - Trojan Njrat variant outbound connection"; flow:to_server,established; flags:PA; content:"|7C 27 7C 27 7C|Win"; fast_pattern:only; content:"|7C 27 7C 27 7C|Yes|7C 27 7C 27 7C|"; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:13082019; sid:5003056; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Trojan MedusaHTTP CnC Checkin"; flow:established,to_server; content:"POST"; http_method; content:"/api.jsp"; http_uri; content:"User-Agent|3a 20|Mozilla/5.0 (X11|3b 20|Ubuntu|3b 20|Linux i686|3b 20|rv|3a|45.0) Gecko/20100101 Firefox/45.0"; http_header; content:"xyz="; depth:4; http_client_body; content:!"Referer|3a|"; reference:url,isc.sans.edu/forums/diary/Recent+example+of+MedusaHTTP+malware/25234/; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:15092019; sid:5003057; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 2404 (msg:"NF - Trojan Remcos-RAT outbound connection"; flow:to_server,established; content:"|1B 84 D5 B0 5D F4 C4 93|"; depth:8; reference:url,www.malware-traffic-analysis.net/2019/09/03/index.html; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:11092019; sid:5003058; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 1024: (msg:"NF - Trojan Remcos-RAT inbound connection"; content:"|80 4f ed 8c fb 77 67 11 62 07 6f de a2 89 c9 2a a9 46 f4 b2 d0 e0 e3 1c 4b fb|"; depth:26;  reference:url,www.malware-traffic-analysis.net/2019/09/03/index.html; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:11092019; sid:5003059; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 80 (msg:"NF - Possible PurpleFox EK - URI Struct"; flow:to_server,established; content:"GET"; depth:3; http_method; pcre:"/\/up.php\?key=[0-9]{1}/Ui"; content:"User-Agent|3a 20|Windows Installer|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:10012021; classtype:trojan-activity; sid:5003060; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - Possible Nugget Phantom malware toolkit"; flow:to_server,established; content:"GET"; depth:3; pcre:"/\/[A-Z0-9]{8}.moe/"; content:"KewGad"; reference:url,networkforensic.dk; metadata:10012021; classtype:trojan-activity; sid:5003061; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [5882,5888,5889] (msg:"NF - Trojan Remcos-RAT or Y3K-RAT outbound connection"; flow:to_server,established; content:"|16 03 03|"; depth:3; reference:url,www.malware-traffic-analysis.net/2021/09/03/index.html; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:26092021; sid:5003062; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 80 (msg:"NF - Guildma Banking Trojan - No alert"; flow:to_server,established; content:"HEAD"; http_method; content:"User-Agent|3A 20|Microsoft BITS"; nocase; pcre:"/\/\?[0-9]{17,33}/U"; flowbits:set,NF-Guildma; flowbits:noalert; reference:url,networkforensic.dk; metadata:30122021; classtype:trojan-activity; sid:5003063; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET 1024: (msg:"NF - Guildma Banking Trojan"; flow:from_server,established; content:"200"; http_stat_code; pcre:"/filename=\"[a-z]{10}\.zip/i"; flowbits:isset,NF-Guildma; reference:url,networkforensic.dk; metadata:30122021; classtype:trojan-activity; sid:5003064; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Trojan Emotet SPAM infected host - 0.0.0.0.spam.abuse.ch"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|01|0|01|0|01|0|04|spam|05|abuse|02|ch"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:trojan-activity; sid:5003065; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Trojan Emotet SPAM infected host - 0.0.0.0.b.barracudacentral.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|01|0|01|0|01|0|01|b|10|barracudacentral|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:trojan-activity; sid:5003066; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Trojan Emotet SPAM infected host - 0.0.0.0.bl.mailspike.net"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|01|0|01|0|01|0|02|bl|09|mailspike|03|net"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:trojan-activity; sid:5003067; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Trojan Emotet SPAM infected host - 0.0.0.0.spam.dnsbl.sorbs.net"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|01|0|01|0|01|0|04|spam|05|dnsbl|05|sorbs|03|net"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:trojan-activity; sid:5003068; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Trojan Emotet SPAM infected host - 0.0.0.0.zen.spamhaus.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|01|0|01|0|01|0|03|zen|08|spamhaus|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:trojan-activity; sid:5003069; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [25,587] (msg:"NF - Trojan Emotet SPAM infected host - Sending malware infected mails"; flow:established; content:"[0.0.0.0]"; reference:url,networkforensic.dk; reference:url,isc.sans.edu/forums/diary/0000+in+Emotet+Spambot+Traffic/28254/"; metadata:19012022; classtype:attempted-user; sid:5003070; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Request for .bmp file"; flow:established,to_server; content:"GET"; http_method; content:".bmp|20|HTTP/1.1|0d 0a|Host|3a 20|"; fast_pattern; content:".bmp"; http_uri; pcre:"/\.bmp$/U"; content:!"Referer|3a|"; http_header; content:!"Accept"; http_header; content:!"User-Agent|3a|"; http_header; content:!"Cache-"; http_header; content:!"Pragma"; http_header; flowbits:set,NF-Metastealer; flowbits:noalert; reference:url,networkforensic.dk; metadata:14042022; classtype:bad-unknown; sid:5003071; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET 1024: (msg:"NF - Possible Metastealer request for bmp file - Check for RTLO in bmp file"; flow:established; content:"301"; http_stat_code; content:"Location: https://"; content:".bmp"; flowbits:isset,NF-Metastealer; reference:url,www.malware-traffic-analysis.net/2022/04/06/index.html; reference:url,networkforensic.dk; metadata:14042022; classtype:misc-activity; sid:5003072; rev:1;)
alert tcp any 1024: -> $EXTERNAL_NET 1024: (msg:"NF - Matanbuchus downloader avtivity - Post payload"; flow:to_server,established; content:"POST"; depth:4; content:"/requets/index.php"; content:"User-Agent|3a 20|"; content:"ms-office"; nocase; content:"ev="; reference:url,networkforensic.dk; metadata:18062022; classtype:trojan-activity; sid:5003073; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Matanbuchus downloader avtivity - C2 - TLS Certificate 1"; flow:to_server,established; ssl_state:client_hello; content:"telemetryservic.com"; reference:url,networkforensic.dk; metadata:18062022; classtype:trojan-activity; sid:5003074; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Matanbuchus downloader avtivity - C2 - TLS Certificate 2"; flow:to_server,established; ssl_state:client_hello; content:"telemetrysystemcollection.com"; reference:url,networkforensic.dk; metadata:19062022; classtype:trojan-activity; sid:5003075; rev:1;)
alert tcp any any -> $EXTERNAL_NET 80 (msg:"NF - Malware Vidar - Password stealer - NO ALERT"; flow:to_server,established; content:"POST"; depth:4; http_method; pcre:"/machineId=\[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}|Admin&configId=[a-z0-9]{32}/i"; flowbits:set,NF-Vidar; flowbits:noalert; reference:url,networkforensic.dk; reference:url,any.run/malware-trends/vidar; metadata:27062022; classtype:trojan-activity; sid:5003076; rev:1;)
alert tcp any any -> $EXTERNAL_NET 80 (msg:"NF - Malware Vidar - Password stealer"; flow:to_server,established; content:"Installed applications:"; flowbits:isset,NF-Vidar; reference:url,networkforensic.dk; reference:url,any.run/malware-trends/vidar; metadata:27062022; classtype:trojan-activity; sid:5003077; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - PUA/Adware - W32/MSIL_Agent.DYX.gen!Eldorado - PDFConverter installed on client - Check Client";  flow:to_server,established; ssl_state:client_hello; content:"go.pdfforge.org"; reference:url,networkforensic.dk; reference:url,www.virustotal.com/gui/file/d23b5c309cfec908fbed8c060d89c7ca512d9c6d0e1bccc8a5fa60a46e67910b/detection; metadata:11102022; classtype:trojan-activity; sid:5003078; rev:1;)
alert tcp $HOME_NET 49600: -> $EXTERNAL_NET !443 (msg:"NF - Malware RemcosRAT C2 connect - NO ALERT";  flow:to_server,established; flags:PA; dsize:160<>170; content:"|00 33 00 47 00 45|"; flowbits:set,NF-RemCOS; flowbits:noalert; reference:url,networkforensic.dk; metadata:03122022; classtype:trojan-activity; sid:5003079; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"NF - Malware RemcosRAT C2 connect";  flow:from_server,established; flags:PA; dsize:128; content:"|f2 97 0c 0b 29 67 25 60 6e c7 a8 a1 33 b3 4d c2|"; flowbits:isset,NF-RemCOS; reference:url,networkforensic.dk; metadata:03122022; classtype:trojan-activity; sid:5003080; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Cloud Shovel - Linux Rootkit - worm capabilities - fullskystar.top"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|www|0b|fullskystar|03|top|00|"; nocase; reference:url,zhuanlan.zhihu.com/p/348960748; reference:url,networkforensic.dk; metadata:05122022; classtype:trojan-activity; sid:5003081; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Cloud Shovel - Linux Rootkit - worm capabilities - xmr-monero.top"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|www|0a|xmr-monero|03|top|00|"; nocase; reference:url,zhuanlan.zhihu.com/p/348960748; reference:url,networkforensic.dk; metadata:05122022; classtype:trojan-activity; sid:5003082; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Trojan Rhadamanthys Stealer"; flow:from_client,established; content:"GET"; depth:3; nocase;  content:"/gjntrrm/zznb2o.hgfq"; http_uri; nocase; reference:url,networkforensic.dk; metadata:06012023; classtype:trojan-activity; sid:5003083; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET any (msg:"NF - POLICY - MS Net.TCP Port Sharing Service in use - Check IP ore domain in URL - High port - No Alert"; flow:established,to_server; dsize:<50; content:"|00 01 00 01 02 02|"; content:"net.tcp://"; flowbits:set,NF-Redline; flowbits:noalert; reference:url,networkforensic.dk; metadata:27022023; classtype:bad-unknown; sid:5003084; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 1024: (msg:"NF - TROJAN - RedLine Stealer - Ending Connection - FlowBit rule"; flow:established,to_Client; dsize:65<>125; content:"|56 02 0b 01 73 04 0b 01 61 06 56 08 44 0a 1e 00 82|"; flowbits:isset,NF-Redline; reference:url,networkforensic.dk; metadata:27022023; classtype:trojan-activity; sid:5003085; rev:1;)
#
#
# NF Mail related - SIGS number range: 5004001 - 5005001
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"NF - SPAM attack on TDC Mail domain - tdc.net"; flow:from_client,established; content:"MAIL FROM:"; nocase; content:"tdc.net"; nocase; reference:url,networkforensic.dk; metadata:15112015; classtype:attempted-recon; sid:5004007; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [25,110,143,587,2525] (msg:"NF - E-mail domain injection spoofing in from field"; flow:to_server,established; content:"From: =?utf-8?Q?"; content:"==?utf-8?Q?=00?==?utf-8?b?"; reference:url,networkforensic.dk; reference:url,www.mailsploit.com; classtype:bad-unknown; sid:5004008; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [25,110,143,587,2525] (msg:"NF - E-mail domain injection XXS attempt in From field - NON b64 encoded"; flow:to_server,established; content:"From|3a 20|"; content:"<iframe onload="; reference:url,networkforensic.dk; reference:url,www.mailsploit.com; classtype:bad-unknown; sid:5004009; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [25,110,143,587,2525] (msg:"NF - E-mail domain injection XXS attempt in From field - b64 encoded"; flow:to_server,established; content:"From|3a 20|"; content:"==?utf-8?Q?=0A=00?="; reference:url,networkforensic.dk; reference:url,www.mailsploit.com; classtype:bad-unknown; sid:5004010; rev:1;)
alert tcp !$SMTP_SERVERS any -> !$SMTP_SERVERS [25,587] (msg:"NF - Outbound mail - NOT from Mailserver"; flow:stateless; content:"ehlo"; within:4; nocase; reference:url,networkforensic.dk; metadata:19042019; classtype:misc-activity; sid:5004011; rev:2;)
alert tcp !$SMTP_SERVERS [25,587] -> !$SMTP_SERVERS any (msg:"NF - Outbound mail connection sectup ESMTP"; flow:to_client,established; content:"ESMTP ready"; nocase; reference:url,networkforensic.dk; metadata:20042019; classtype:misc-activity; sid:5004012; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"NF - Outbound mail setup command EHLO"; flow:from_client,established; content:"ehlo"; within:4; nocase; reference:url,networkforensic.dk; metadata:31102019; classtype:misc-activity; sid:5004013; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] (msg:"NF - Outbound mail setup command HELO"; flow:from_client,established; content:"helo"; within:4; nocase; reference:url,networkforensic.dk; metadata:31102019; classtype:misc-activity; sid:5004014; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"NF - POLICY - HTTP GET Request on SMTP mail port"; content:"GET / HTTP/1.0"; reference:url,networkforensic.dk; metadata:19122021; classtype:misc-activity; sid:5004015; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"NF - POLICY - tnscmd10g PJL Command - Prod the oracle tnslsnr process on SMTP mail port"; content:"@PJL USTATUS DEVICE=OFF"; reference:url,networkforensic.dk; metadata:19122021; classtype:misc-activity; sid:5004016; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 25 (msg:"NF - BotNet BruteForce - Password guessing attack - ylmf-pc - Cutwail/Pushdo"; flow:established; content:"ylmf-pc"; reference:url,networkforensic.dk; reference:url,www.researchgate.net/publication/309115701_Analysis_of_Brute_Force_Attacks_with_Ylmf-pc_Signature; metadata:17012022; classtype:attempted-user; sid:5004017; rev:2;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [25,587] (msg:"NF - Outbound mail client containing IP address in ehlo command - Check host possible SPAM malware - Emotet"; content:"ehlo"; nocase; pcre:"/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/"; reference:url,networkforensic.dk; metadata:23012022; classtype:misc-activity; sid:5004018; rev:1;)
#
#
# NF USER AGENTS  - SIGS number range: 5005000 - 5006000
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - USER_AGENTS Suspicious Mozilla User-Agent Likely Fake (Mozilla/5.0)"; flow:to_server,established; content:"User-Agent|3a| Mozilla/5.0|0d 0a|"; fast_pattern:5,20; nocase; http_header; content:!"|0d 0a|Host|3a| download.releasenotes.nokia.com"; http_header; content:!"Mozilla/5.0|0d 0a|Connection|3a| Close|0d 0a 0d 0a|"; http_header; reference:url,networkforensic.dk; metadata:27122014; classtype:misc-activity; sid:5005000; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - USER_AGENTS - PowerShell User agent - Download"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"User-Agent|3a 20|Mozilla/5.0|20|"; content:"WindowsPowerShell"; nocase; http_header; reference:url,networkforensic.dk; metadata:22092019; classtype:bad-unknown; sid:5005001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - USER_AGENTS - Known Windows Curl User-Agent Outbound - Check files"; flow:established,to_server; content:"User-Agent|3a 20|curl/7."; nocase; http_header; reference:url,networkforensic.dk; metadata:25032022; classtype:unknown; sid:5005002; rev:2;)
#
#
# BackConnect Protocol  - Used by malware like DarkVNC, IcedID, Bazar, and QakBot -  - SIGS number range: 5006001 - 5007001
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Malware W32.DarkVNC - Variant 1 - NO ALERT"; flow:established,to_server; dsize:13; content:"|4a 01 4f 97|"; fast_pattern; flowbits:set,NF-DarkVNC1; flowbits:noalert; reference:url,networkforensic.dk; metadata:30062022; classtype:trojan-activity; sid:5006001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Malware W32.DarkVNC - Variant 1"; flow:established,to_server; content:"|56 4e 43 20|"; flowbits:isset,NF-DarkVNC1; reference:url,networkforensic.dk; metadata:30062022; classtype:trojan-activity; sid:5006002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Malware W32.DarkVNC - Variant 2 - NO ALERT"; flow:established,to_server; content:"|53 00 00 00 19|"; fast_pattern; flowbits:set,NF-DarkVNC2; flowbits:noalert; reference:url,networkforensic.dk;  metadata:30062022; classtype:trojan-activity; sid:5006003; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - Malware W32.DarkVNC - Variant 2";  flow:established,to_client; fragbits:D; dsize:16; content:"|00 00 56 6b|"; depth:8; flowbits:isset,NF-DarkVNC2; reference:url,networkforensic.dk; metadata:30062022; classtype:trojan-activity; sid:5006004; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [443,8080] (msg:"NF - BackConnect Protocol - 1"; flow:to_server,established; flags:AP; dsize:13; content:"|4a 01 4f 97 01|"; depth:5; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:21082022; classtype:trojan-activity; sid:5006005; rev:4;)
alert tcp $EXTERNAL_NET [443,8080] -> $HOME_NET 1024: (msg:"NF - BackConnect Protocol - Wait Command";  flow:established; flags:AP; dsize:13; content:"|01 3c 00 00 00|"; offset:4; depth:5; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:02112022; classtype:trojan-activity; sid:5006006; rev:4;)
alert tcp $EXTERNAL_NET [443,8080] -> $HOME_NET 1024: (msg:"NF - BackConnect Protocol - Start VNC command";  flow:established; flags:AP; dsize:13; content:"|4a 01 4f 97 05|"; offset:0; depth:5; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:03112022; classtype:trojan-activity; sid:5006007; rev:3;)
alert tcp $EXTERNAL_NET [443,8080] -> $HOME_NET 1024: (msg:"NF - BackConnect Protocol - Start file manager command";  flow:established; flags:AP; dsize:13; content:"|1f 8b 08 08 12|"; offset:0; depth:5; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:03112022; classtype:trojan-activity; sid:5006008; rev:4;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [443,8080] (msg:"NF - BackConnect Protocol - Fake Gzip";  flow:established; flags:AP; content:"|1f 8b 08 08|"; offset:0; depth:4; flowbits:set,NF-BackConnectProtocol; flowbits:noalert; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:03112022; classtype:trojan-activity; sid:5006009; rev:3;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [443,8080] (msg:"NF - BackConnect Protocol - ReverseShell active";  flow:established; flags:AP; content:"Active code page: 65001"; offset:0; depth:23; flowbits:isset,NF-BackConnectProtocol; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:03112022; classtype:trojan-activity; sid:5006010; rev:3;)
alert tcp $EXTERNAL_NET [443,8080] -> $HOME_NET 1024: (msg:"NF - BackConnect Protocol - Start VNC command - 11";  flow:established; flags:AP; dsize:13; content:"|1f 8b 08 08 11|"; offset:0; depth:5; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2022-10&post=IcedID-BackConnect-Protocol; metadata:03112022; classtype:trojan-activity; sid:5006011; rev:3;)
#
#
# NF Ring Door Bell - SIGS number range: 5007001 - 5007100
alert udp $EXTERNAL_NET any -> $HOME_NET 15063 (msg:"NF - RingDoorBell - VOIP INVITE Message 200 OK - Unencrypted telephone SIP Call"; content:"SIP/2.0 200 OK"; nocase; depth:14; content:"@ring.com"; nocase; within:135; reference:url,networkforensic.dk; classtype:policy-violation; sid:5007001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - RingDoorBell - Outgoing Basic Auth Base64 HTTP - Password detected un-encrypted - Ring"; flow:to_server,established; content:"POST"; depth:4; content:"/doorbots_api/dings"; http_uri; content:"|0d 0a|Authorization|3a 20|Basic"; nocase; http_header; content:"fw.ring.com"; http_header; reference:url,networkforensic.dk; metadata:20122015; classtype:policy-violation; sid:5007002; rev:2;)
#
#
# NF Tunneling IP - SIGS number range: 5007101 - 5007200
alert ip any any -> any any (msg:"NF - IP-IP tunneling detected"; ip_proto:94; reference:url,networkforensic.dk; reference:url,www.informit.com/articles/article.aspx?p=101171&seqNum=6; metadata:25012015; sid:5007101; classtype:misc-activity; rev:1;)
alert ip any any -> any any (msg:"NF - ETHERIP tunneling detected - Ethernet-within-IP Encapsulation"; ip_proto:97; reference:url,networkforensic.dk; reference:url,www.informit.com/articles/article.aspx?p=101171&seqNum=6; metadata:25012015; sid:5007102; classtype:misc-activity; rev:1;)
alert ip any any -> any any (msg:"NF - ENCAP tunneling detected - Yet Another IP encapsulation"; ip_proto:98; reference:url,networkforensic.dk; reference:url,www.informit.com/articles/article.aspx?p=101171&seqNum=6; metadata:25012015; sid:5007103; classtype:misc-activity; rev:1;)
alert ip any any -> any any (msg:"NF - Loose source routing attempt"; ipopts: lsrr; reference:url,networkforensic.dk; reference:url,informit.com/articles/article.aspx?p=101171&seqNum=6; metadata:20122014; sid:5007104; classtype:misc-activity; rev:1;)
alert tcp $EXTERNAL_NET 53 -> $HOME_NET 1024: (msg:"NF - Possible File download on TCP DNS PORT - TXT Record - Packet over 100 Bytes - Check for covert channel"; flow:from_server,established; flags:AP; dsize:100<>1514; content:"|01 00|"; offset:2; content:"|00 10 00 01|"; reference:url,blog.didierstevens.com/2019/08/07/downloading-executables-over-dns-capture-files; reference:url,networkforensic.dk; metadata:18082019; classtype:misc-activity; sid:5007105; rev:1;)
#
#
# Heimdalsecurity when best (Useres can't see what have been blocked with this tool - Be carefull if you use it, it will block thing you my need) - SIGS number range: 5007201 - 5009000
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Access to heimdalsecurity blocking page - What have been blocked"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"Host: blockedbyheimdalsecurity.com"; reference:url,networkforensic.dk; metadata:22072022; classtype:misc-activity; sid:5007201; rev:1;)
#
#
# Vulnerabilities / Exploits - SIGS number range: 5009001 - 5009300
alert udp any any -> any any (msg:"NF - TLP:WHITE - Realtek eCOS SDK SIP Traffic Exploit"; content: "invite"; depth: 6; nocase; content: "m=audio "; isdataat: 128,relative; content:!"|0d|"; within: 128; reference:url,networkforensic.dk; reference:cve,CVE-2022-27255; metadata:16082022; classtype:attempted-admin; sid:5009001; rev:1;)
#
#
# Free range - SIGS number range: 5009301 - 5010000
#
#
# Blocked by danish law - SIGS number range: 5010001 - 5010100
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Blocking page by Rettighedsalliancen - Blocked by Danish law"; flow:to_client,established; file_data; content:"<title>Sharewithcare.dk - Blokeringsskilt Front-end</title>"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:10082022; classtype:policy-violation; sid:5010001; rev:1;) 
#
#
# NF FSB Intelligence service - SIGS number range: 5010201 - 5010300
alert tcp 213.24.76.0/23 any -> $HOME_NET any (msg:"NF - FSB IP Range Traffice detected - Outside to inside - TCP"; detection_filter:track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:12042016; classtype:misc-activity; sid:5010201; rev:3;)
alert udp 213.24.76.0/23 any -> $HOME_NET any (msg:"NF - FSB IP Range Traffice detected - Outside to inside - UDP"; detection_filter:track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:12042016; classtype:misc-activity; sid:5010202; rev:3;)
#
#
# NF Web-Defacement - SIGS number range: 5010301 - 5012000
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Possible Website defacement - Hacked by - Generic rule - Inbound"; flow:to_client,established; file_data; content:"Hacked by"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:15032015; classtype:misc-activity; sid:5010301; rev:2;) 
alert tcp $HOME_NET 80 -> $EXTERNAL_NET any (msg:"NF - Possible Website defacement - Hacked by - Generic rule - Outbound"; flow:to_client,established; file_data; content:"Hacked by"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:15032015; classtype:misc-activity; sid:5010302; rev:2;) 
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Possible Website defacement - Fucked by 7sign - Inbound"; flow:to_client,established; file_data; content:"<title>Fucked by 7sign"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:26112017; classtype:misc-activity; sid:5010303; rev:1;) 
alert tcp $HOME_NET 80 -> $EXTERNAL_NET any (msg:"NF - Possible Website defacement - Fucked by 7sign - outbound"; flow:established; file_data; content:"<title>Fucked by 7sign"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:26112017; classtype:misc-activity; sid:5010304; rev:1;) 
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Possible Website defacement - Title 0wn3d  - Generic rule - Inbound"; flow:to_client,established; file_data; content:"<title>0wn3d</title>"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:15032015; classtype:misc-activity; sid:5010305; rev:1;) 
alert tcp $HOME_NET 80 -> $EXTERNAL_NET any (msg:"NF - Possible Website defacement - Title 0wn3d - Generic rule - Outbound"; flow:to_client,established; file_data; content:"<title>0wn3d</title>"; nocase; fast_pattern:only; reference:url,networkforensic.dk; metadata:15032015; classtype:misc-activity; sid:5010306; rev:1;) 
#
#
# NF Microsoft AD CertUtil - SIGS number range:5013051 - 5013100
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - IOC - Microsoft AD CertUtil - Downloading - Not normal - check downloaded file"; flow:to_server,established; content:"GET"; http_method; content:"User-Agent|3A 20|CertUtil URL Agent"; content:!"windowsupdate.com"; content:!"microsoft.com"; uricontent:!".crl"; reference:url,networkforensic.dk; reference:url,securityaffairs.co/wordpress/67997/cyber-crime/botnet-attacking-italian-firms.html; reference:url,carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html; metadata:21012018; classtype:bad-unknown; sid:5013051; rev:1;)
#
#
# NF TOP triggred rules from Honypot Systems - Please also see rules from Emergingthreats ore Networkforensic - SIGS number range: 5013401 - 5013500
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - VNC server response"; flow:established; content:"RFB 0"; depth:5; content:".0"; depth:2; offset:7; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:misc-activity; sid:5013401; rev:1;)
alert tcp any any -> $HOME_NET 445 (msg:"NF - EXPLOIT [PTsecurity] DoublePulsar Backdoor installation communication"; flow: to_server, established; content:"|FF|SMB2|00 00 00 00|"; depth: 9; offset: 4; byte_test:2,!=,0x0000,52,relative,little; pcre: "/^.{52}(?:\x04|\x09|\x0A|\x0B|\x0C|\x0E|\x11)\x00/R"; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013402; rev:1;)
alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"NF - Telnet bad Login"; flow:from_server,established; content:"Login incorrect"; fast_pattern:only; nocase; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:bad-unknown; sid:5013403; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF - Telnet suspicious path to BusyBox"; flow:to_server,established; content:"/bin/busybox"; flowbits:set,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:suspicious-filename-detect; sid:5013404; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF - Telnet suspicious to BusyBox"; flow:to_server,established; content:"/bin/busybox"; flowbits:set,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:suspicious-filename-detect; sid:5013405; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF TELNET busybox MIRAI hackers - Possible Brute Force Attack"; flow:to_server,established; content:"MIRAI"; flowbits:isset,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013406; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF TELNET busybox ECCHI hackers - Possible Brute Force Attack"; flow:to_server,established; content:"ECCHI"; flowbits:isset,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013407; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF TELNET busybox MEMES Hackers - Possible Brute Force Attack"; flow:to_server,established; content:"MEMES"; flowbits:isset,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013408; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF - Telnet suspicious busybox shell"; flow:to_server,established; content:"shell"; pcre:"/\bshell\b/"; flowbits:isset,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013409; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"NF - Telnet suspicious busybox enable"; flow:to_server,established; content:"enable"; pcre:"/\benable\b/"; flowbits:isset,NF.telnet.busybox; detection_filter:track by_src, count 1, seconds 30; reference:url,networkforensic.dk; reference:url,doc.emergingthreats.net; metadata:11122018; classtype:attempted-admin; sid:5013410; rev:3;)
#
#
# NF FTP - SIGS number range: 55013501 - 5013700
alert tcp $EXTERNAL_NET 21 -> $HOME_NET 1023: (msg:"NF - FTP login attempt - response from server"; flow:to_client,established; content:"220"; depth:3; content:"server ready"; nocase; reference:url,networkforensic.dk; metadata:28062015; classtype:policy-violation; sid:55013501; rev:2;)
alert tcp $HOME_NET 1023: -> $EXTERNAL_NET 21 (msg:"NF - FTP login - Username from Client Send"; flow:to_server,established; content:"USER"; nocase; depth:4; reference:url,networkforensic.dk; metadata:28062015; classtype:policy-violation; sid:55013502; rev:2;)
alert tcp $HOME_NET 1023: -> $EXTERNAL_NET 21 (msg:"NF - FTP login - Password from Client Send"; flow:to_server,established; content:"PASS"; nocase; depth:4; reference:url,networkforensic.dk; metadata:28062015; classtype:policy-violation; sid:55013503; rev:2;)
alert tcp $EXTERNAL_NET 21 -> $HOME_NET 1023: (msg:"NF - FTP login - Password accepted"; flow:to_client,established; content:"230"; depth:3; content:"login accepted"; nocase; reference:url,networkforensic.dk; metadata:28062015; classtype:policy-violation; sid:55013504; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"NF - FTP STOR Command"; flow:to_server,established; content:"STOR"; nocase; reference:url,networkforensic.dk; metadata:27012017; classtype:policy-violation; sid:55013505; rev:3;)
#
#
# ISCSI device login - SIGS number range: 5013701 - 5014400
alert tcp $EXTERNAL_NET 3260 -> $HOME_NET 1023: (msg:"NF - ISCSI - ISCSI auth message None - Mounted device on External net - Auth None used - Data in clear txt"; flags:PA; content:"AuthMethod=None"; nocase; reference:url,networkforensic.dk; metadata:13122018; classtype:policy-violation; sid:5013701; rev:1;)
alert tcp $EXTERNAL_NET 3260 -> $HOME_NET 1023: (msg:"NF - ISCSI - ISCSI device running non protected to Internet - Mounted device on External net - Auth CHAP used - Data in clear txt"; flags:PA; content:"AuthMethod=CHAP"; nocase; reference:url,networkforensic.dk; metadata:13122018; classtype:policy-violation; sid:5013702; rev:1;)
alert tcp $HOME_NET 1023: -> $EXTERNAL_NET 3260 (msg:"NF - ISCSI - ISCSI auth message None - Mounted device on Internal net - Auth None used - Data in clear txt"; flags:PA; content:"AuthMethod=None"; nocase; reference:url,networkforensic.dk; metadata:13122018; classtype:policy-violation; sid:5013703; rev:1;)
alert tcp $HOME_NET 1023: -> $EXTERNAL_NET 3260  (msg:"NF - ISCSI - ISCSI device running non protected over Internet - Mounted device on Internal net - Auth CHAP used - Data in clear txt"; flags:PA; content:"AuthMethod=CHAP"; nocase; reference:url,networkforensic.dk; metadata:13122018; classtype:policy-violation; sid:5013704; rev:1;)
#
#
# NF Covert Channels - SIGS number range: 5016101 - 5017100
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - Malicious DNS TXT Response - DNS Tunnelling"; content:"|00 10 00 01|"; pcre:"/\d{4}.01.\d{4}.[a-g0-9]{4}.[a-g]{1}[0-9]{3}.0000/i"; detection_filter:track by_dst, count 1000, seconds 5; reference:url,networkforensic.dk; metadata:08072015; classtype:misc-activity; sid:5016101; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Payload contains - Windows PowerShell Running - Covert Channel"; fragbits:D; itype:8; icode:0; dsize:90<>129; content:"windows PowerShell running"; nocase; reference:url,networkforensic.dk; metadata:08072015; classtype:misc-activity; sid:5016102; rev:1;)
#alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Windows icmp Type 8 Code 0 - payload change"; itype:8; icode:0; content:!"abcdefghijklmnopqrstuvwabcdefghi"; nocase; content:!"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI"; content:!"ABCDEFGHIJKLMNOPQRSTUVWXYZ123456"; nocase; reference:url,networkforensic.dk; metadata:01122014; classtype:misc-activity; sid:5016103; rev:5;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Information Reply undefined code"; icode:>0; itype:16; classtype:misc-activity; sid:5016104; rev:8;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Don't Fragment bit set - check for covert channel"; fragbits:D; itype:8; icode:0; detection_filter:track by_src, count 3, seconds 5; metadata:08122014; classtype:misc-activity; sid:5016105; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Payload contains - Get-Process - Covert Channel"; itype:0; icode:0; dsize:12<>129; content:"Get-Process"; nocase; reference:url,networkforensic.dk; metadata:12072015; classtype:misc-activity; sid:5016106; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Payload contains - Whoami - Covert Channel"; itype:0; icode:0; dsize:7<>129; content:"whoami"; nocase; reference:url,networkforensic.dk; metadata:12072015; classtype:misc-activity; sid:5016107; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Payload to big for normal use - Covert Channel"; dsize:100<>130; detection_filter:track by_dst, count 50, seconds 10; reference:url,networkforensic.dk; metadata:12072015; classtype:misc-activity; sid:5016108; rev:1;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - ICMP Type 8 Code 0 - Large Ping outbound"; itype:8; icode:0; dsize:>800; reference:url,en.wikipedia.org/wiki/Ping_of_death; reference:url,networkforensic.dk; metadata:09052017; classtype:misc-activity; sid:5016109; rev:2;)
alert udp $EXTERNAL_NET 53 -> !$SMTP_SERVERS any (msg:"NF - DNS TXT Response - Not to mail-servers"; content:"|00 10 00 01 c0 0c|"; content:!"|70 75 73 68 05 61 70 70 6C 65 03 63 6F 6D|"; content:!"aaplcache"; reference:url,networkforensic.dk; metadata:16062017; classtype:policy-violation; sid:5016110; rev:1;)
alert icmp any any -> any any (msg:"NF - Echo Request Payload - Bigger than 100 bytes"; icode:0; itype:8; dsize:>100; reference:url,networkforensic.dk; metadata:25032019; classtype:misc-activity; sid:5016111; rev:1;)
alert icmp any any -> any any (msg:"NF - Echo Reply Payload - Bigger than 100 bytes"; icode:0; itype:0; dsize:>100; reference:url,networkforensic.dk; metadata:25032019; classtype:misc-activity; sid:5016112; rev:1;)
alert icmp any any -> any any (msg:"NF - SSH TAG in ICMP traffic"; content:"SSH-"; reference:url,networkforensic.dk; metadata:24122017; classtype:misc-activity; sid:5016113; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET [53,5353,53532] (msg:"NF - Potential DNS Tunneling"; content:"|01 00|"; within :4; content:"|00 00 10 00 01|"; within:255; detection_filter:track by_src, count 70, seconds 1; reference:url,networkforensic.dk; metadata:24122017; classtype:misc-activity; sid:5016114; rev:2;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"NF - Potential NSTX DNS Tunneling"; content:"|01 00|"; within:4; content:"cT"; offset:12; depth:3; content:"|00 10 00 01|"; within:255; reference:url,networkforensic.dk; metadata:24122017; classtype:misc-activity; sid:5016115; rev:1;)
alert udp any [53,5353,53532] -> any 1024: (msg:"NF - Potential DNSCAT2 DNS Tunnelling"; content:"|00 00 10 00 01|"; pcre:"/[a-z0-9]{34}\x0/i"; detection_filter:track by_dst, count 70, seconds 1; reference:url,networkforensic.dk; reference:url,www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-5.html; metadata:06032022; classtype:misc-activity; sid:5016116; rev:1;)
#
#
#
# NF Company Policy Violation - OLD User Agents and other - SIGS number range: 5017401 - 5017500
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows XP making Internet connection - IE 8 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 8.0"; nocase; http_header; content:"Windows NT 5.1"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017401; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows XP making Internet connection - IE 7 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 7.0"; nocase; http_header; content:"Windows NT 5.1"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017402; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows XP making Internet connection - IE 6 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 6.0"; nocase; http_header; content:"Windows NT 5.1"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017403; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2003 server making Internet connection - IE 8 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 8.0"; nocase; http_header; content:"Windows NT 5.2"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017404; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2003 server making Internet connection - IE 7 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 7.0"; nocase; http_header; content:"Windows NT 5.2"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017405; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2003 server making Internet connection - IE 6 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 6.0"; nocase; http_header; content:"Windows NT 5.2"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:22072015; classtype:policy-violation; sid:5017406; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2008 server making internet connection - IE 7 - Unsupported browser - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 7.0"; nocase; http_header; content:"Windows NT 6.0"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:12032016; classtype:policy-violation; sid:5017407; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2008 server making internet connection - IE 8 - Unsupported browser - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 8.0"; nocase; http_header; content:"Windows NT 6.0"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:12032016; classtype:policy-violation; sid:5017408; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"NF - POLICY - WinHTTP Web Proxy Auto-Discovery Service running on endpoint - Can allow MITM attacks - Disable service"; flow:established; content:"User-Agent|3a 20|WinHttp-Autoproxy-Service|2f|"; nocase; http_header; reference:url,networkforensic.dk; metadata:02102018; classtype:policy-violation; sid:5017409; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - TLS connection to notifier.win-rar.com - Host running WinRar"; flow:to_server,established; ssl_state:client_hello; content:"notifier.win-rar.com"; reference:url,research.checkpoint.com/extracting-code-execution-from-winrar; reference:url,networkforensic.dk; metadata:27022019; classtype:policy-violation; sid:5017410; rev:1;)
alert tcp any any -> any any (msg:"NF - POLICY - WinHTTP Web-Proxy Auto-Discovery Service running on endpoint - Can allow MITM attacks - Disable service"; flow:established,to_server; content:"GET /wpad.dat HTTP/1.1"; nocase; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2012-07&post=WPAD-Man-in-the-Middle; metadata:11062019; classtype:policy-violation; sid:5017411; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 7 making Internet connection - IE 11 - Company Policy Violation"; flow:from_client,established; content:"User-Agent|3a 20|"; http_header; content:"Windows NT 6.1"; nocase; http_header; content:"rv:11.0"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:160820; classtype:policy-violation; sid:5017412; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Brave Browser are likely installed - TOR traffic likely to follow"; flow:to_server,established; ssl_state:client_hello; content:"variations.brave.com"; reference:url,networkforensic.dk; metadata:22022021; classtype:policy-violation; sid:5017413; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,23,25,80,110,143,587,8080] (msg:"NF - POLICY - Danish CPR number in clear txt"; flow:established; detection_filter:track by_src, count 5, seconds 30; pcre:"/\s[0-3]{1}\d{1}[0,1]{1}\d{1}\d{2}(\s|-)\d{4}\D/"; reference:url,networkforensic.dk; metadata:21102021; classtype:policy-violation; sid:5017414; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 2008 R2 server making internet connection - IE 9 - Unsupported browser - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 9.0"; nocase; http_header; content:"Windows NT 6.1"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:26122021; classtype:policy-violation; sid:5017415; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Windows 8 server making internet connection - IE 10 - Unsupported browser - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 10.0"; nocase; http_header; content:"Windows NT 6.2"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:26122021; classtype:policy-violation; sid:5017416; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Internet Explorer 11 - End of life - June 15 2022 - IE 11 - Company Policy Violation"; flow:established,to_server; content:"User-Agent|3a 20|"; http_header; content:"MSIE 11.0"; nocase; http_header; content:"Windows NT 6.3"; nocase; http_header; fast_pattern:only; reference:url,networkforensic.dk; metadata:26122021; classtype:policy-violation; sid:5017417; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Internet Explorer 11 - End of life - June 15 2022 - IE 11 - Connection from server 2016 ore 2019 - Company Policy Violation"; flow:established; content:"User-Agent|3a 20|"; http_header; content:"Windows NT 10.0"; nocase; http_header; content:"11.0"; nocase; http_header; fast_pattern:only; content:!"Firefox/111.0"; content:!"Firefox/112.0"; content:!"Firefox/113.0"; content:!"Firefox/114.0"; content:!"Firefox/115.0"; content:!"Firefox/116.0"; content:!"Firefox/117.0"; content:!"Firefox/118.0"; content:!"Firefox/119.0"; content:!"Firefox/120.0"; reference:url,networkforensic.dk; metadata:27122021; classtype:policy-violation; sid:5017418; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - wpad.dk - No Alert"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"Host|3a 20|wpad.dk|0d|"; nocase; http_header; flowbits:set,EC-wpad_dk; flowbits:noalert;  reference:url,networkforensic.dk; metadata:20042023; classtype:misc-activity; sid:5017419; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - wpad.dk - Check wpad setting in infrastructur"; flow:from_server,established; content:"200"; http_stat_code; content:"FindProxyForURL"; flowbits:isset,EC-wpad_dk; reference:url,networkforensic.dk; reference:url,www.netresec.com/?page=Blog&month=2012-07&post=WPAD-Man-in-the-Middle; metadata:20042023; classtype:misc-activity; sid:5017420; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - CCleaner installed - Anti-Forensic - Check host"; flow:to_server,established; ssl_state:client_hello; content:"analytics.ff.avast.com"; reference:url,networkforensic.dk; reference:url,www.synacktiv.com/en/publications/ccleaner-forensics.html; metadata:24042023; classtype:policy-violation; sid:5017421; rev:1;)
#
#
# F-Respone Forensic Kit - SIGS number range: 5017601 - 5017800
alert tcp $EXTERNAL_NET any -> $HOME_NET 5682 (msg:"NF - Information - Connection to local F-Response License manager server"; flow:established; dsize:155<>165; content:"/lm"; content:"Sec-WebSocket-Key|3a 20|"; nocase; reference:url,networkforensic.dk; metadata:2402209; classtype:not-suspicious; sid:5017601; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3262 (msg:"NF - Information - Connection to Remote F-Response Client"; flow:from_client,established; dsize:160<>170; content:"/sub"; content:"Sec-WebSocket-Key|3a 20|"; nocase; reference:url,networkforensic.dk; metadata:2402209; classtype:not-suspicious; sid:5017602; rev:1;)
#
#
# NF TLD - gTLD - Domains have high risk of malware - https://www.spamhaus.org/statistics/tlds/ - SIGS number range: 5017801 - 5018100
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - .su DNS quer"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|SU|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk meadata:20042015; classtype:bad-unknown; sid:5017801; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - .ru DNS query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|RU|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk meadata:20042015; classtype:bad-unknown; sid:5017802; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - .cn DNS query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|CN|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk meadata:20042015; classtype:bad-unknown; sid:5017803; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - .cc DNS query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|CC|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk meadata:20042015; classtype:bad-unknown; sid:5017804; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - xyz DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|xyz|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017805; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - blue DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|blue|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017806; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - pink DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|pink|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017807; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - futbol DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|futbol|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017808; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - report DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|report|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017809; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - computer DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|08|computer|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017810; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - camera DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|camera|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017811; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - link DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|camera|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017812; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - travel DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|travel|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017813; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - vacations DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|09|vacations|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017814; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - berlin DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|berlin|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017815; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - club DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|club|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017816; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - company DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|company|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017817; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - consulting DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0a|consulting|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017818; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - domains DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|domains|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017819; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - email DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|email|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017820; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - enterprises DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0b|enterprises|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017821; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - guru DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|guru|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017822; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - pictures DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|08|pictures|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017823; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - solutions DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|09|solutions|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017824; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - bid DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|bid|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017825; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - cf DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|cf|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017826; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - click DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|click|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017827; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - download DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|08|download|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017828; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - ga DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|08|download|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017829; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - gdn DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|gdn|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017830; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - gq DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|gq|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017831; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - kim DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|kim|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017832; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - loan DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|loan|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017833; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - ml DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|ml|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017834; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - party DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|party|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017835; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - review DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|review|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017836; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - science DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|science|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017837; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - space DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|space|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017838; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - stream DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|stream|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017839; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - tk DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|tk|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017840; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - top DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|top|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017841; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - trade DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|trade|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017842; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - win DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|win|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017843; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - zip DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|zip|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:22092016; classtype:bad-unknown; sid:5017844; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - xin DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|xin|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017845; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - country DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|country|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017846; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - cricket DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|cricket|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017847; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - date DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|date|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017848; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - jetzt DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|jetzt|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017849; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - men DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|men|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017850; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - mom DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|mom|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017851; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - pw DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|pw|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017852; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - racing DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|racing|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017853; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - ren DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|ren|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017854; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - vip DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|vip|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017855; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - wang DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|wang|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017856; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - work DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|work|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017857; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - accountants DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0b|accountants|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017858; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - bit DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|bit|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:18062018; classtype:bad-unknown; sid:5017859; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - ICQ DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|icq|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:19032019; classtype:bad-unknown; sid:5017860; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - best DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|best|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:14032020; classtype:bad-unknown; sid:5017861; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - buzz DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|buzz|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:14032020; classtype:bad-unknown; sid:5017862; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - fit DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|fit|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:14032020; classtype:bad-unknown; sid:5017863; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - ml DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|ml|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:14032020; classtype:bad-unknown; sid:5017864; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - site DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|site|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:14032020; classtype:bad-unknown; sid:5017865; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - cyou DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|cyou|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:23112020; classtype:bad-unknown; sid:5017866; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - london DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|06|london|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:23112020; classtype:bad-unknown; sid:5017867; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - casa DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|casa|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:23112020; classtype:bad-unknown; sid:5017868; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Bad TLD domain - surf DNS query - Check domains"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|surf|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:23112020; classtype:bad-unknown; sid:5017869; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTPS connection to possible bad web-site - Certificate with TDL - london, fit, work, gdn, fail, casa, rest, Top, cryo, club, xyz, viajes, link, surf ore click domain detected"; flow:from_client,established; ssl_state:client_hello; pcre:"/\.(london|fit|work|gdn|fail|viajes|casa|rest|top|cryo|club|xyz|click|link|surf)/i"; reference:url,networkforensic.dk; metadata:22112020; classtype:policy-violation; sid:5017870; rev:6;)
#
#
# NF KeyGrabber Wi-Fi Premium Keylogger - SIGS number range: 5018101 - 5018200
alert tcp $HOME_NET any -> any 25 (msg:"NF - KeyGrabber Wi-Fi Premium Keylogger - Sending keylogs to mail server"; content:"Subject:"; content:"==> KeyGrabber USB Wi-Fi Report <=="; nocase; reference:url,networkforensic.dk; reference:url,www.keelog.com/wifi_hardware_keylogger.html; metadata:02082015; classtype:trojan-activity; sid:5018101; rev:2;)
alert tcp $HOME_NET 1024: -> any 25999 (msg:"NF - KeyGrabber Wi-Fi Premium Keylogger - Log download request - password exposed in 3 characters"; flow:to_server,established; content:"Get Log"; nocase; depth:7; pcre:"/[A-Z]{3}/i"; reference:url,networkforensic.dk; reference:url,www.keelog.com/wifi_hardware_keylogger.html; metadata:02082015; classtype:trojan-activity; sid:5018102; rev:2;)
#
#
# Spyware / Virus - SIGS number range: 5018201 - 5018400
alert udp $HOME_NET any -> any 53 (msg:"NF - IOC - POLICY DNS - supertuneup.com - Riskware/SuperTuneup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|www|0b|supertuneup|03|com"; nocase; reference:url,networkforensic.dk; metadata:16072019; classtype:misc-activity; sid:5018201; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Riskware/SuperTuneup - Updating with new payloads"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/update.asp"; nocase; http_uri; content:"www.supertuneup.com"; nocase; http_header; reference:url,networkforensic.dk; metadata:16072019; classtype:trojan-activity; sid:5018202; rev:1;)
alert tcp any any -> any any (msg:"NF - Policy - Riskware/SuperTuneup detected on SMB traffic"; flow:established; content:"|fe 53 4d 42|"; content:"|63 00 69 00 66 00 73 00 2f 00|"; content:"|53 00 75 00 70 00 65 00 72 00 54 00 75 00 6e 00 65 00 75 00 70 00 2e 00 63 00 6f 00 6d 00|"; reference:url,networkforensic.dk; metadata:16072019; classtype:misc-activity; sid:5018203; rev:1;)
#
#
# NF Lenovo Service Engine LSE BIOS Vulnerability - SIGS number range: 5018401 - 5018410
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Lenovo - (LSE) BIOS Vulnerability - Update Check detected"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/ideapad/windows/lsebios/"; nocase; http_uri; content:"download.lenovo.com"; nocase; http_header; reference:url,networkforensic.dk; reference:url,support.lenovo.com/us/en/product_security/lse_bios_desktop; metadata:14082015; classtype:trojan-activity; sid:5018401; rev:2;)
#
#
# NF Generic - SIGS number range: 5018801 - 5019000
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - Generic - Large number of NXDOMAIN replies"; content:!"|07|spamcop|03|net"; content:!"|10|spameatingmonkey|03|net"; content:!"|08|spamhaus|03|org"; content:!"|05|sorbs|03|net"; content:!"|14|support-intelligence|03|net"; content:!"|05|surbl|03|org"; flow:to_client; byte_test:1,&,2,3; byte_test:1,&,1,3; byte_test:1,&,128,2; detection_filter:track by_src, count 120, seconds 60; reference:url,networkforensic.dk; metadata:25102015; classtype:misc-activity; sid:5018801; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Generic -  Error 522 - Connection timed out - Check client for old compromise"; content:"522"; http_stat_code; reference:url,isc.sans.edu/forums/diary/522+Error+Code+for+the+Win/21377/; reference:url,networkforensic.dk; metadata:18082016; classtype:policy-violation; sid:5018802; rev:2;)
alert udp !$SMTP_SERVERS any -> $EXTERNAL_NET 53 (msg:"NF - Generic - DNS TXT Standard query - Not from mail-servers - Check for covert channel"; content:"|01 00|"; offset:2; depth:4; content:"|00 00 10 00 01|"; offset:12; depth:255; reference:url,networkforensic.dk; metadata:22052018; classtype:policy-violation; sid:5018803; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - Generic - DNS Response 127.0.0.1 - Possible sinkholed domain - Check domain"; content:"|00 04 7f 00 00 01|"; reference:url,networkforensic.dk; metadata:28082018; classtype:bad-unknown; sid:5018804; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Generic - icanhazip.com - icanhazip.com GET Request - Used for IP checking by malware"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"Host|3a 20|icanhazip.com|0d|"; http_header; nocase; reference:url,networkforensic.dk; metadata:28032022; flowbits:set,NF-icanhazip; flowbits:noalert; classtype:misc-activity; sid:5018805; rev:4;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Generic - icanhazip.com IP lookup - Often used in malware campaigns - Check host for unwanted software"; flow:from_server,established; content:"200"; http_stat_code; content:"X-SECURITY|3a 20|This site DOES NOT distribute malware|2e 20|Get the facts|2e 20|"; flowbits:isset,NF-icanhazip; reference:url,networkforensic.dk; metadata:17102018; classtype:misc-activity; sid:5018806; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Generic POST rule on PORT 443"; flow:to_server,established; content:"POST"; depth:4; nocase; http_method; reference:url,networkforensic.dk; metadata:21052016; classtype:misc-activity; sid:5018807; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Generic - WebDAV request for SysVol Outbound"; flow:to_server,established; content:"PROPFIND"; http_method; content:"/SysVol/"; nocase; http_uri; content:"User-Agent|3a 20|Microsoft-WebDAV-MiniRedir/"; http_header; reference:url,networkforensic.dk; metadata:18082016; classtype:misc-activity; sid:5018808; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Generic - extreme-ip-lookup.com in hostname and GET Request - No Alert"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"Host|3a 20|extreme-ip-lookup.com|0d|"; nocase; http_header; flowbits:set,NF-extremeiplookup; flowbits:noalert; reference:url,networkforensic.dk; metadata:20082019; classtype:misc-activity; sid:5018809; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Generic - extreme-ip-lookup.com IP lookup - Used by Lord EX and other malware campaigns - Check host for unwanted software"; flow:from_server,established; content:"200"; http_stat_code; content:"businessName"; flowbits:isset,NF-extremeiplookup; reference:url,networkforensic.dk; metadata:12082019; classtype:misc-activity; sid:5018810; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Generic - Download Request from Wordpress Folder - Likely Malicious"; flow:established,to_server; content:"GET"; depth:3; http_method; content:"/wp-"; http_uri; content:".exe"; http_uri; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/\.exe$/U"; pcre:"/\/wp-(?:content|admin|includes)\//U"; reference:url,networkforensic.dk; classtype:trojan-activity; metadata:11092019; sid:5018811; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET 1024: (msg:"NF - Generic - Exe file masquerading using Right-to-Left Override - MITRE - T1036 - Defense Evasion"; flow:from_server,established; content:"edom SOD ni nur eb tonnac margorp sihT";  nocase; reference:url,networkforensic.dk; metadata:18032022; classtype:trojan-activity; sid:5018812; rev:2;) 
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Generic - HTTP Traffic on Websocket"; flow:established; content:"101"; http_stat_code; content:"websocket"; nocase; reference:url,www.geeksforgeeks.org/what-is-web-socket-and-how-it-is-different-from-the-http; reference:url,networkforensic.dk; metadata:06012023; classtype:bad-unknown; sid:5018813; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Generic - Webdav PROPFIND request for BAT, DLL, Manifest ore Config file"; flow:to_server,established; content:"PROPFIND"; http_method; content:"/webdav/"; nocase; http_uri; content:"User-Agent|3a 20|Microsoft-WebDAV-MiniRedir/"; http_header; pcre:"/(|\.bat|\.dll|\.Manifest|\.config)/Ui"; reference:url,networkforensic.dk; metadata:25022023; classtype:misc-activity; sid:5018814; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - Generic - Net.TCP Port Sharing Service in use - Check IP ore domain in URL"; flow:established,to_server; dsize:<50; content:"|00 01 00 01 02 02|"; content:"net.tcp://"; reference:url,networkforensic.dk; metadata:27022023; classtype:bad-unknown; sid:5018815; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"NF - Exploit attempt - Curl command in Ike2 VPN packet - Inbound"; content:"|29 20 22|"; fast_pattern; content:"curl"; nocase; reference:url,networkforensic.dk; metadata:13072023; classtype:misc-attack; sid:5018816; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"NF - Exploit attempt - wget command in Ike2 VPN packet - Inbound"; content:"|29 20 22|"; fast_pattern; content:"wget"; nocase; reference:url,networkforensic.dk; metadata:13072023; classtype:misc-attack; sid:5018817; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET [53,5353] (msg:"NF - MALWARE - Generic Lu0bot-Style DNS Query in DNS Lookup"; dsize:90<>95; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; fast_pattern; pcre:"/[0-9a-z]{61}.[a-z]{3}.[a-z0-9]{5,6}.[a-z]{3,4}/"; content:!"cnr.io"; reference:url,networkforensic.dk; reference:url,any.run/cybersecurity-blog/lu0bot-analysis; metadata:29092023; classtype:trojan-activity; sid:5018818; rev:3;)
# 
#
# NF HTtrack metadata not removed - used by phishing - SIGS number range: 55019001 - 5019100
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - IOC - Website mirrored with HTTrack - Tool used by some phishing campaigns"; flow:from_server,established; file_data; content:"<!-- Mirrored"; nocase; file_data; content:"HTTrack Website Copier"; nocase; reference:url,networkforensic.dk; metadata:16112015; classtype:misc-activity; sid:55019001; rev:2;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - IOC - Website mirrored with HTTrack - Metadata tag not removed - <!-- Added by HTTrack -->"; flow:from_server,established; file_data; content:"<!-- Added by HTTrack -->"; nocase; reference:url,networkforensic.dk; metadata:16112015; classtype:misc-activity; sid:55019002; rev:2;)
#
#
# Eternal Blue CVE-2017-0144 - SIGS number range: 5019101 - 5019200
alert tcp any any -> $HOME_NET any (msg:"NF - ETERNALBLUE - Possible ETERNALBLUE Probe - SMB Pipe Protocol Request - Metasploit"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00|"; offset:4; depth:9; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:5; within:10; content:"|23 00 00 00 07 00 5c 50 49 50 45 5c 00|"; fast_pattern; isdataat:!1,relative;  reference:url,cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144; reference:url,networkforensic.dk; metadata:28092019; classtype:attempted-recon; sid:5019101; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"NF - ETERNALBLUE - Probe Vulnerable System Response - STATUS_INSUFF_SERVER_RESOURCES - Metasploit"; flow:from_server,established; content:"|ff|SMB|25 05 02 00 c0 98 01|"; offset:4; depth:11; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:3; within:10; content:"|00 00 00|"; distance:8; within:3; isdataat:!1,relative;  reference:url,cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144; reference:url,networkforensic.dk; metadata:28092019; classtype:trojan-activity; sid:5019102; rev:1;)
#
# 
# NF NTPD Kiss-o'-Death - SIGS number range: 5019501 - 5019600
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 10"; content:"|e4 00 0a|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019501; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 11"; content:"|e4 00 0b|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019502; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 12"; content:"|e4 00 0c|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019503; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 13"; content:"|e4 00 0d|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019504; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 14"; content:"|e4 00 0e|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019505; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 15"; content:"|e4 00 0f|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019506; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 16"; content:"|e4 00 10|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019507; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 17"; content:"|e4 00 11|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019508; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 18"; content:"|e4 00 12|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019509; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 19"; content:"|e4 00 13|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019510; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 20"; content:"|e4 00 14|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019511; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 21"; content:"|e4 00 15|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019512; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 22"; content:"|e4 00 16|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019513; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 23"; content:"|e4 00 17|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019514; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 24"; content:"|e4 00 18|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019515; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 (msg:"NF - NTPD Kiss-o'-Death - Peer Polling Interval 25"; content:"|e4 00 19|"; offset:0; depth:3; content:"|52 41 54 45|"; distance:5; within:15; reference:url,www.cs.bu.edu/~goldbe/NTPattack.html; reference:cve,2015-7704; reference:url,networkforensic.dk; metadata:05032016; classtype:bad-unknown; sid:5019516; rev:1;)
#
#
# POLICY Rules - SIGS number range: 5019601 - 5020000
alert udp any any -> 224.0.0.252 5355 (msg:"NF - POLICY - LLMNR - Link-local Multicast name resolution in use - Unsafe to use"; content:"|00 00 00 01|"; reference:url,networkforensic.dk; metadata:26012020; classtype:policy-violation; sid:5019601; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - CCCleaner in use - Anti-Forensic"; flow:from_client,established; ssl_state:client_hello; content:"verify.ccleaner.com"; reference:url,networkforensic.dk; metadata:18072022; classtype:policy-violation; sid:5019602; rev:1;)
#
#
# NF DDOS attacks - SIGS number range: 5020101 - 5020200
alert udp $EXTERNAL_NET any -> $HOME_NET 28015 (msg:"NF - DDOS attack on RUST gaming server"; detection_filter:track by_dst, count 800, seconds 5; content:"TSource Engine Query"; nocase; depth:24; reference:url,networkforensic.dk; metadata:09042016; classtype:attempted-dos; sid:5020101; rev:3;)
alert udp $EXTERNAL_NET any -> $HOME_NET 389 (msg:"NF - Crafted CLDAP packets used for DOS/DDos attacks - INBOUND"; detection_filter:track by_dst, count 700, seconds 1; content:"objectclass0"; offset:34; depth:12; reference:url,networkforensic.dk; metadata:23102016; classtype:attempted-dos; sid:5020102; rev:2;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"TDC-SOC – Possible BlackNurse attack from external source 3,3"; itype:3; icode:3; detection_filter:track by_dst, count 250, seconds 1; reference:url,soc.tdc.dk/blacknurse/blacknurse.pdf; metadata:18032016; classtype:attempted-dos; sid:5020103; rev:2;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"TDC-SOC – Possible BlackNurse attack from internal source 3,3"; itype:3; icode:3; detection_filter:track by_dst, count 250, seconds 1; reference:url,soc.tdc.dk/blacknurse/blacknurse.pdf; metadata:18032016; classtype:attempted-dos; sid:5020104; rev:2;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"TDC-SOC – Possible BlackNurse attack from external source 3,4"; itype:3; icode:4; detection_filter:track by_dst, count 250, seconds 1; reference:url,soc.tdc.dk/blacknurse/blacknurse.pdf; metadata:18032016; classtype:attempted-dos; sid:5020105; rev:2;)
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"TDC-SOC – Possible BlackNurse attack from internal source 3,4"; itype:3; icode:4; detection_filter:track by_dst, count 250, seconds 1; reference:url,soc.tdc.dk/blacknurse/blacknurse.pdf; metadata:18032016; classtype:attempted-dos; sid:5020106; rev:2;)
alert udp $EXTERNAL_NET any -> any 11211 (msg:"NF - Possible Memcached DDoS Amplification - Query set"; content:"|00 00 00 00 00 01 00|"; depth:7; fast_pattern; content:"|0d 0a|"; distance:0; within:20; isdataat:!1,relative; detection_filter:track by_dst, count 100, seconds 60; flowbits:set,NF_memcached; reference:url,networkforensic.dk; reference:url,www.arbornetworks.com/blog/asert/memcached-reflection-amplification-description-ddos-attack-mitigation-recommendations; metadata:03032018; classtype:attempted-dos; sid:5020107; rev:2;)
alert udp any 11211 -> $EXTERNAL_NET any (msg:"NF - Possible Memcached DDoS Amplification Response - Outbound"; flowbits:isset,NF_memcached; content:"STATS|20|pid"; depth:9; fast_pattern; detection_filter:track by_dst, count 100, seconds 60; reference:url,networkforensic.dk; reference:url,www.arbornetworks.com/blog/asert/memcached-reflection-amplification-description-ddos-attack-mitigation-recommendations; metadata:03032018; classtype:attempted-dos; sid:5020108; rev:1;) 
alert udp $EXTERNAL_NET 11211 -> $HOME_NET any (msg:"NF - Possible Memcached DDoS Amplification - Inbound"; content:"STATS|20|pid"; depth:9; fast_pattern; detection_filter:track by_dst, count 100, seconds 60; reference:url,networkforensic.dk; reference:url,www.arbornetworks.com/blog/asert/memcached-reflection-amplification-description-ddos-attack-mitigation-recommendations; metadata:03032018; classtype:attempted-dos; sid:5020109; rev:1;)
#alert udp $EXTERNAL_NET any -> $HOME_NET 27015: (msg:"NF - AMPLIFICATION DDOS WITH GAME SERVERS - TSource Engine Query StatusResponse - UDP"; content:"|ff ff ff ff 73 74 61 74 75 73 52 65 73 70 6f 6e 73 65|"; nocase; offset:0; depth:18; detection_filter:track by_src, count 5, seconds 30; reference:url,networkforensic.dk; reference:"url,grehack.org/files/2013/talks/talk_3_5-nolla-ddos_amplification_attacks_with_game_servers-grehack.pdf"; metadata:05032015; classtype:attempted-dos; sid:5020110; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NF - Tors Hammer slow post flood attempt"; flow:established,to_server; content:"POST / HTTP/1.1|0D 0A|"; depth:17; content:"Keep-Alive: 900|0D 0A|Content-Length: 10000|0D 0A|"; fast_pattern:only; reference:url,networkforensic.dk; metadata:TDC-SOC-CERT,18032016; classtype:attempted-dos; sid:5020111; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NF - SlowLoris - Windows GUI Tool used"; flow:established,to_server; detection_filter:track by_src, count 5, seconds 5; content:"User-Agent|3a|"; http_header; content:"Mozilla/4.0"; http_header; content:"MSIE 7.0"; http_header; content:"Windows NT 5.1"; http_header; content:"Trident/4.0"; http_header; content:"NET CLR 1.1.4322"; http_header; content:"NET CLR 2.0.503l3"; http_header; content:"NET CLR 3.0.4506.2152"; http_header; content:"NET CLR 3.5.30729"; http_header; content:"MSOffice 12"; http_header; reference:url,networkforensic.dk; metadata:18032016; classtype:attempted-dos; sid:5020112; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"NF - Slowloris HTTP Traffic Inbound"; flow:to_server,established; content:"Content-Length|3a| 42|0d 0a|"; http_header; fast_pattern:only; content:"|0d 0a|X-a|3a 20|b|0d 0a|"; isdataat:!1,relative; detection_filter:track by_dst, count 10, seconds 60; reference:url,networkforensic.dk; metadata:18032016; classtype:attempted-dos; sid:5020113; rev:2;)
alert udp $EXTERNAL_NET 19 -> $HOME_NET any (msg:"NF - Sign on Chargen UDP attack"; detection_filter:track by_dst, count 300, seconds 5; reference:url,networkforensic.dk; metadata:01042016; classtype:attempted-dos; sid:5020114; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET 4444 (msg:"NF - Sign on DNS Amplification Attack"; detection_filter:track by_dst, count 500, seconds 5; reference:url,networkforensic.dk; metadata:01042016; classtype:attempted-dos; sid:5020115; rev:1;)
alert udp $EXTERNAL_NET 123 -> $HOME_NET any (msg:"NF - Sign on NTP Amplification Attack"; detection_filter:track by_dst, count 1500, seconds 5; reference:url,networkforensic.dk; metadata:01042016; classtype:attempted-dos; sid:5020116; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 80 (msg:"NF - Possible Wordpress ping banck attack"; flow:not_established; content:"GET"; depth:3; http_method; content:"X-Pingback-Forwarded-For:"; nocase; http_header; reference:url,networkforensic.dk; metadata:23052016; classtype:attempted-dos; sid:5020117; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - UDP Based DOS LOIC Low Orbit Ion Cannon Attack Default String"; content:"A cat is fine too. Desudesudesu~"; dsize:32; detection_filter: track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:02072016; classtype:attempted-dos; sid:5020118; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - UDP Based D0S LOIC Low Orbit Ion Cannon Attack OUTBOUND Default String"; dsize:32; content:"A cat is fine too. Desudesudesu~"; detection_filter: track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:02072016; classtype:attempted-dos; sid:5020119; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - TCP Based DOS LOIC Low Orbit Ion Cannon Attack Default String"; dsize:32; content:"A cat is fine too. Desudesudesu~"; detection_filter: track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:02072016; classtype:attempted-dos; sid:5020120; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - TCP Based DOS LOIC Low Orbit Ion Cannon Attack OUTBOUND Default String"; dsize:32; content:"A cat is fine too. Desudesudesu~"; detection_filter: track by_src, count 5, seconds 30; reference:url,networkforensic.dk; metadata:02072016; classtype:attempted-dos; sid:5020121; rev:2;)
alert udp $EXTERNAL_NET 1900 -> $HOME_NET any (msg:"NF - Possible UPnP or SSDP DDOS Attack"; detection_filter:track by_src, count 175, seconds 1; reference:url,networkforensic.dk; metadata:08082016; classtype:attempted-dos; sid:5020122; rev:1;)
alert tcp $EXTERNAL_NET 53 -> $HOME_NET 1023: (msg:"NF - DNS SIGRED DOS - Attack"; dsize:>300; content:"|00 18|"; content:"|0f ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; classtype:misc-attack; reference:url,networkforensic.dk; reference:cve,CVE-2020-1350; metadata:24072020; sid:5020123; rev:1;)
alert tcp $EXTERNAL_NET any -> any any (msg:"NF - SYN packets with a payload - Not allowed according to RFC793  - youporn - Reflected DDOS from middleboxses"; ttl:>128; flags:S; dsize:1<>65535; content:"youporn"; reference:url,arstechnica.com/information-technology/2022/03/unending-data-floods-and-complete-resource-exhaustion-ddoses-get-meaner; reference:url,networkforensic.dk; metadata:15052022; classtype:trojan-activity; sid:5020124; rev:1;)
alert tcp $EXTERNAL_NET any -> any any (msg:"NF - SYN packets with a payload - Not allowed according to RFC793 - roxypalace - Reflected DDOS from middleboxses"; ttl:>128; flags:S; dsize:1<>65535; content:"roxypalace"; reference:url,arstechnica.com/information-technology/2022/03/unending-data-floods-and-complete-resource-exhaustion-ddoses-get-meaner; reference:url,networkforensic.dk; metadata:15032022; classtype:trojan-activity; sid:5020125; rev:1;)
alert tcp any any -> any any (msg:"NF - Warning - Network Congestion problem or TCP SYN DDOS Attack - Window 0 size"; flow:not_established; detection_filter:track by_dst, count 250, seconds 5; flags:S; window:0; reference:url,networkforensic.dk; metadata:06082022; classtype:denial-of-service; sid:5020126; rev:1;)
#
#
# Bad TCP packets - Possible reflected DDOS from middelbokses - Possible Port knocking - SIGS number range: 5020201 - 5020400
alert tcp $EXTERNAL_NET any -> any any (msg:"NF - SYN packets with a payload - Not allowed according to RFC793 - Can be Port knocking - Reflected DDOS from middelbokses"; flags:S; dsize:1<>65535; reference:url,arstechnica.com/information-technology/2022/03/unending-data-floods-and-complete-resource-exhaustion-ddoses-get-meaner; reference:url,networkforensic.dk; metadata:03032022; classtype:trojan-activity; sid:5020201; rev:1;)
alert tcp $EXTERNAL_NET any -> any any (msg:"NF - FIN packets with a payload - Not allowed according to RFC793 - Can be Port knocking - Reflected DDOS from middelbokses"; flags:F; dsize:1<>65535; reference:url,networkforensic.dk; metadata:03032022; classtype:trojan-activity; sid:5020202; rev:1;)
#
#
# NF BITSadmin download tool - SIGS number range: 5020401 - 5020500
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 5.0 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/7.7|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020401; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 4.0 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/7.5|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020402; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 3.0 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/7.0|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020403; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 2.5 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/6.7|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020404; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 2.0 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/6.6|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020405; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 1.5 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/6.5|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020406; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 1.2 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/6.2|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020407; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 1.0 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/6.0|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:08052016; classtype:misc-activity; sid:5020408; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Bitsadmin tool used to do downloads - BITS 10.1 - NOT a Microsoft Domain"; flow:established,to_server; content:"User-Agent|3a 20|Microsoft BITS/7.8|0d 0a|"; http_header; content:!"windowsupdate.com|0d 0a|"; nocase; http_header; content:!"microsoft.com|0d 0a|"; content:!"office.net|0d 0a|"; nocase; http_header; reference:url,networkforensic.dk; metadata:12092020; classtype:misc-activity; sid:5020409; rev:5;)
#
#
# NF PUA - SIGS number range: 5020501 - 5020600
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ASOC Custom - BLACKLIST User Agent - PCAcceleratePro)"; flow:established,to_server; content:"User-Agent|3A 20|PCAcceleratePro"; http_header; reference:url,www.malwareviz.com/T4/static/html/MalwareViz_e6b495b4842f81aa9fed02ccf0f2541c.html#; reference:url,networkforensic.dk; metadata:19052016; classtype:misc-activity; sid:5020501; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ASOC Custom - BLACKLIST User Agent Spigot - WidgiToolbar"; flow:established,to_server; content:"User-Agent|3A 20|WidgiToolbar"; http_header; reference:url,malwaretips.com/blogs/searchsettings-exe-removal/; reference:url,networkforensic.dk; metadata:19052016; classtype:misc-activity; sid:5020502; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ASOC Custom - Malware User Agent - DriverRestore)"; flow:established,to_server; content:"User-Agent|3A 20|DriverRestore"; http_header; nocase; reference:url,www.shouldiremoveit.com/DriverRestore-121212-program.aspx; reference:url,networkforensic.dk; metadata:19052016; classtype:misc-activity; sid:5020503; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ASOC Custom - Malware User Agent - DriverWhiz)"; flow:established,to_server; content:"User-Agent|3A 20|DriverWhiz"; http_header; nocase; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2015-071014-4617-99&tabid=2; reference:url,networkforensic.dk; metadata:19052016; classtype:misc-activity; sid:5020504; rev:1;)
#
#
# NF TOR Network identification - PORT 9001,9002 needs to be added to sensor network snort.conf file - SIGS number range: 5021501 - 5021510
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Possible TOR browser starting up - Typical TOR DNS name - Check DNS domain in certificate"; detection_filter:track by_src, count 3, seconds 3; flow:from_client,established; ssl_state:client_hello; pcre:"/www\.[a-z0-9]{20,25}\.(com|net)/i"; reference:url,networkforensic.dk; metadata:28022022; classtype:policy-violation; sid:502150; rev:4;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [9001,9002] (msg:"NF - POLICY - TOR-Browser in use - TOR SSL NAT Check Detected - Typical TOR DNS name"; flow:from_client,established; pcre:"/www\.[a-z0-9]{6,25}\.(com|net)/i"; reference:url,networkforensic.dk; metadata:01012023; classtype:policy-violation; sid:502151; rev:5;)
#
#
# Abnormal traffic - SIGS number range: 5021511 - 5021550
alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Test beacon on ICMP traffic observed"; itype:8; icode:0; content:"test"; nocase; reference:url,networkforensic.dk; metadata:11122020; classtype:misc-activity; sid:5021512; rev:1;)
#
#
# NF Kerio mailserver - SIGS number range: 5021551 - 5021600
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"NF - Kerio-Mailserver - SMTP Relay attempt"; flow:to_client,established; content:"5.7.1 Relaying"; nocase; content:"denied"; fast_pattern; nocase; reference:url,networkforensic.dk; metadata:28072016; classtype:misc-activity; sid:5021551; rev:1;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"NF - Kerio-Mailserver - Authentication failed - Suspected password attack"; flow:to_client,established; detection_filter:track by_src, count 15, seconds 1; content:"5.7.0 Authentication failed"; nocase; reference:url,networkforensic.dk; metadata:28072016; classtype:misc-activity; sid:5021552; rev:1;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"NF - Kerio-Mailserver - Unknown authentication method - Suspected password attack"; flow:to_client,established; detection_filter:track by_src, count 20, seconds 2; content:"504 5.7.6 Unknown authentication method"; nocase; reference:url,networkforensic.dk; metadata:5021553; classtype:misc-activity; sid:5021553; rev:1;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"NF - Kerio-Mailserver - SPAM - Caller-ID failed"; flow:to_client,established; detection_filter:track by_src, count 2, seconds 5; content:"550 5.7.0 Caller-ID for the message does not match"; nocase; reference:url,networkforensic.dk; metadata:28072016; classtype:misc-activity; sid:5021554; rev:1;)
#alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS [465,995,8843] (msg:"NF - Kerio-Mailserver - Possible SSL Bruteforce attempt on mail server"; flow:to_server,established; ssl_state:client_hello; detection_filter:track by_src, count 3000, seconds 5; reference:url,networkforensic.dk; metadata:28072016; classtype:misc-activity; sid:5021555; rev:5;)
#
#
# NF RAT Detection - SIGS number range: 5021601 - 5021700
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF´- NetWiredRC Trojan-RAT registration to C2"; fragbits:D; flags:PA; flow:to_server,established; pkt_data; content:"|41 00 00 00 99|"; offset:0; depth:10; flowbits:set,NF-NetWiredRC; flowbits:noalert; reference:url,networkforensic.dk; metadata:26082019; classtype:trojan-activity; sid:5021601; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 1024: (msg:"NF - NetWiredRC Trojan-RAT heartbeat to C2"; dsize:5; flags:PA; flow:from_server,established; pkt_data; content:"|01 00 00 00 97|"; offset:0; depth:10; detection_filter:track by_src, count 15, seconds 10; flowbits:isset,NF-NetWiredRC; reference:url,networkforensic.dk; metadata:26082019; classtype:trojan-activity; sid:5021602; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET any (msg:"NF - Trojan NetSupport RAT"; flow:to_server,established; content:"POST"; depth:4; content:"/fakeurl.htm"; nocase; pcre:"/Host|3a 20|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}.[0-9]{1,3}/"; content:"User-Agent|3A 20|NetSupport Manager/1.3"; nocase; reference:url,networkforensic.dk; metadata:01092019; classtype:trojan-activity; sid:5021603; rev:1;)
alert tcp $EXTERNAL_NET 4782 -> $HOME_NET 1024:  (msg:"NF - Possible Quasar-RAT Connections - APT 10 - Check the host"; flow:from_server,established; dsize:68; content:"|40 00 00 00|"; reference:url,malware-traffic-analysis.net/2019/09/24/index.html; reference:url,networkforensic.dk; metadata:25092019; classtype:trojan-activity; sid:5021604; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Crimson - Trojan-RAT - Server connection check"; flow:established,to_server; content:"POST"; depth:4; http_method; content:"crimson|5f|version|3d|"; http_client_body; nocase; reference:url,networkforensic.dk; metadata:22032020; classtype:trojan-activity; sid:5021605; rev:1;) 
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - AsyncRAT - Trojan-RAT - Connection to outside"; flow:established; content:"|16 03 01|"; depth:3; content:"Async"; nocase; content:!"asyncgw.teams.microsoft.com"; content:!"async-px.dynamicyield.com"; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021606; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - AsyncRAT - Trojan-RAT - Server Running on internal network"; flow:established; content:"|16 03 01|"; depth:3; content:"Async"; nocase; content:!"asyncgw.teams.microsoft.com"; content:!"async-px.dynamicyield.com"; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021607; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - CrimsonRat - Trojan-RAT - CNC command"; flow:established,to_client; content:"|00 00 00 00|"; offset: 1; depth: 4; pcre:"/\x00\x00\x00\x00(thumb|filsz|rupth|dowf|endpo|scrsz|cscreen|dirs|stops|scren|cnls|udlt|delt|afile|listf|file|info|runf|fles|dowr|info|fldr)+=/"; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021608; rev:1;) 
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NetWiredRC - Trojan-RAT - Check-in request"; flow:established,to_server; dsize:69; content:"|41 00 00 00 99|"; offset:0; depth:5; flowbits:set,NF-NetwireRAT.Client; flowbits:noalert; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021609; rev:1;) 
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NetWiredRC - Trojan-RAT - Check-in response"; flow:established,to_server; dsize:5; content:"|3f 00 00 00 9b|"; flowbits:isset,NF-NetwireRAT.Client; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021610; rev:1;) 
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - AsyncRAT - Trojan-RAT - Connection to outside"; flow:established,to_client; content:"|16 03 01|"; offset:0; depth:3; content:"AsyncRAT"; distance:0; fast_pattern; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021611; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - QuasarRAT - Trojan-RAT - CNC response header"; flow:established,to_client; dsize:68; content:"|40 00 00 00|"; offset: 0; depth: 4; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021612; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - AgentTesla CNC via FTP/SMTP"; flow:established,to_server; content:"|3C|html|3E|Time|3A|"; content:"|3C|br|3E|User Name|3A|"; content:"|3C|br|3E|Computer Name|3A|"; distance: 0; content: "|3C|br|3E|OSFullName|3A|"; distance: 0; content:"CPU|3A|"; distance: 0; content:"|3C|br|3E|RAM|3A|"; distance: 0; content: "URL|3A|"; distance: 0; content: "Application|3A|"; distance: 0; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021613; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"NF - CyberGate - Trojan-RAT - Data Exfiltration"; flow:established,to_server; dsize:40<>300; pcre:"/\d{2,3}[#$]{4,6}\x0d\x0a/"; content:"|23 23 24 23 23 0d 0a|"; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021614; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - Nanocore - Trojan-RAT - Generic C&C command (response)"; flow:established,to_client; flowbits:set,NF-NanocoreGen; flowbits:noalert; content:"|20 00 00 00|"; offset:0; depth:4; byte_test:1,!=,0,5,relative; dsize:36; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021615; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Nanocore - Trojan-RAT - Generic C&C command (request)"; flow:established,to_server; flowbits:isset,NF-NanocoreGen; dsize:12; content:"|08 00 00 00|"; offset:0; depth:4; byte_test:1,!=,0,5,relative; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021616; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Nanocore - Trojan-RAT - Pulse check"; flow:established,to_server; dsize:12; content:"|08 00 00 00|"; offset: 0; depth: 4; content:"|c1 c3 d0 32 43 59 a1 78|"; distance:0; within:8; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021617; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NjRat - Trojan-RAT - Data Exfil activity"; flow:to_server,established; content:"|00|ll"; offset:3; depth:3; pcre:"/^\d{1,3}\x00/"; pcre:"/(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?/"; flowbits:set,NF-njrat; flowbits:noalert; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021618; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - NjRat - Trojan-RAT - Data Exfil activity"; flow:to_server,established; content:"|00|inf"; offset:3; depth:4; pcre:"/\d{1,3}\x00\w{1,3}/"; pcre:"/(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?/"; flowbits:isset,NF-njrat; reference:url,networkforensic.dk; metadata:18022022; classtype:trojan-activity; sid:5021619; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET any (msg:"NF - Trojan NetSupport RAT - Client connection to manager"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"/location/loca.asp"; nocase; http_uri; content:"|0d 0a|Host|3a 20|geo.netsupportsoftware.com";  reference:url,networkforensic.dk; metadata:26022023; classtype:trojan-activity; sid:5021620; rev:1;)
#
#
# Cobolt Strike - Pentest Tool  - SIGS number range: 5022051 - 5022100
alert tcp any any -> any any (msg:"FOX-IT - Trojan - Possible CobaltStrike C2 Server"; flow:to_client; content:"HTTP/1.1 200 OK |0d0a|"; fast_pattern; depth:18; content:"Date: "; pcre:"/^HTTP/1.1 200 OK \r\nContent-Type: [^\r\n]{0,100}\r\nDate: [^\r\n]{0,100} GMT\r\n(Content-Length: \d+\r\n)\r\n/"; reference:url,blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild; reference:url,networkforensic.dk; metadata:03032019; classtype:trojan-activity; sid:5022051; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - NanoHTTPD used by remote web-server - Cobolt Strike default webServer - Check connection"; flow:from_server,established; content:"Server: NanoHTTPD"; nocase; http_header; classtype:misc-activity; metadata:07032019; sid:5022052; rev:1;)
#
#
# NF Suspicious Behavior - SIGS number range: 5022101 - 5022200
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Http:// in User-Agent string"; flow:to_server,established; content:"GET"; nocase; http_method; content:"User-Agent: http://"; nocase; http_header; classtype:misc-activity; reference:url,networkforensic.dk; metadata:01102016; sid:5022101; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Https:// in User-Agent string"; flow:to_server,established; content:"GET"; nocase; http_method; content:"User-Agent: https://"; nocase; http_header; classtype:misc-activity; reference:url,networkforensic.dk; metadata:01102016; sid:5022102; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - ftp:// in User-Agent string"; flow:to_server,established; content:"GET"; nocase; http_method; content:"User-Agent: ftp://"; nocase; http_header; classtype:misc-activity; reference:url,networkforensic.dk; metadata:01102016; sid:5022103; rev:1;)
#
#
# NF Ask Toolbar - SIGS number range: 5022501 - 5022600
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Ask toolbar in use - update"; flow:established,to_server; content:"User-Agent|3a 20|APNU|0d 0a|"; http_header; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022501; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Ask toolbar in use - Properties"; flow:established,to_server; content:"User-Agent|3a 20|AskPartnerCobranding|0d 0a|"; http_header; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022502; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Ask toolbar in use - Toolbar"; flow:established,to_server; content:"User-Agent|3a 20|AskToolbar|0d 0a|"; http_header; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022503; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Ask toolbar has been installed"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/installed?"; nocase; http_uri; content:"supertoolbar.ask.com"; nocase; http_header; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022504; rev:1;)
alert udp any any -> any 53 (msg:"NF - POLICY ask.com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|ask|03|com"; fast_pattern; nocase; distance:0; reference:url,blog.redcanary.com/ask-partner-network-compromise; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022505; rev:1;)
alert tcp $HOME_NET any -> 95.183.52.220 80 (msg:"NF - Ask toolbar malware - payload download"; content:"GET"; http_method; content:"/download/logo.png"; nocase; http_uri; reference:url,blog.redcanary.com/ask-partner-network-compromise; reference:url,networkforensic.dk; metadata:24112016; classtype:policy-violation; sid:5022506; rev:1;)
#
#
# NF Calyx TOR anonymiser device - SIGS number range: 5022601 - 5022650
alert tcp [162.247.72.7,162.247.72.199,162.247.72.200,162.247.72.212,162.247.72.216,162.247.72.217,162.247.73.11,162.247.73.12,162.247.73.74,162.247.73.192,162.247.74.7,162.247.74.27,162.247.74.74,162.247.74.197,162.247.74.200,162.247.74.201,162.247.74.202,162.247.74.204,162.247.74.206,162.247.74.213,162.247.74.216,162.247.74.217] any -> $HOME_NET any (msg:"NF - POLICY - Calyx TOR anonymiser device - known IP range - TCP"; flow:to_server,established; reference:url,networkforensic.dk; reference:url,calyxinstitute.org; metadata:19032020; classtype:misc-activity; sid:5022601; rev:1;)
alert udp [162.247.72.7,162.247.72.199,162.247.72.200,162.247.72.212,162.247.72.216,162.247.72.217,162.247.73.11,162.247.73.12,162.247.73.74,162.247.73.192,162.247.74.7,162.247.74.27,162.247.74.74,162.247.74.197,162.247.74.200,162.247.74.201,162.247.74.202,162.247.74.204,162.247.74.206,162.247.74.213,162.247.74.216,162.247.74.217] any -> $HOME_NET any (msg:"NF - POLICY - Calyx TOR anonymiser device - known IP range - UDP"; detection_filter:track by_dst, count 5, seconds 2; reference:url,networkforensic.dk; reference:url,calyxinstitute.org; metadata:19032020; classtype:misc-activity; sid:5022602; rev:1;)
alert icmp [162.247.72.7,162.247.72.199,162.247.72.200,162.247.72.212,162.247.72.216,162.247.72.217,162.247.73.11,162.247.73.12,162.247.73.74,162.247.73.192,162.247.74.7,162.247.74.27,162.247.74.74,162.247.74.197,162.247.74.200,162.247.74.201,162.247.74.202,162.247.74.204,162.247.74.206,162.247.74.213,162.247.74.216,162.247.74.217] any -> $HOME_NET any (msg:"NF - POLICY - Calyx TOR anonymiser device - known IP range - ICMP"; detection_filter:track by_dst, count 2, seconds 5; reference:url,networkforensic.dk; reference:url,calyxinstitute.org; metadata:19032020; classtype:misc-activity; sid:5022603; rev:1;)
#
#
# NF File Type Downloads - SIGS number range: 5022651 - 5022700
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Policy - RAR file type download"; flow:established; file_data; content:"|52 61 72 21|"; offset:0; depth:4; reference:url,networkforensic.dk; metadata:21122016; classtype:bad-unknown; sid:5022651; rev:1;)
#
#
# Signal encryption on mobile phone - SIGS number range: 5022701 - 5023201
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Signal encryption is used on mobile Phone - whispersystems"; ssl_state:client_hello; content:"textsecure-service.whispersystems.org"; reference:url,networkforensic.dk; metadata:27072020; classtype:policy-violation; sid:5022701; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Signal encryption is used on mobile Phone - signal.org"; ssl_state:client_hello; content:"cdn.signal.org"; reference:url,networkforensic.dk; metadata:27-07-2020; classtype:policy-violation; sid:5022702; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $EXTERNAL_NET any (msg:"NF - POLICY - Signal encryption is used on mobile Phone with invalid CERT from - whispersystems"; content:"TextSecure"; content:"|00 89 ba 2d ab 4a e4 f3 62|"; reference:url,networkforensic.dk; metadata:27072020; classtype:policy-violation; sid:5022703; rev:1;)
#
#
# Punycode domains - COM and DK - SIGS number range: 5023351 - 5023360
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - Punycode domain lookup to COM,DK domains"; detection_filter:track by_dst, count 2, seconds 2; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/xn--[a-z0-9\-]{1,256}(.com|.dk)/i"; reference:url,www.xudongz.com/blog/2017/idn-phishing; reference:url,networkforensic.dk; metadata:18042017; classtype:bad-unknown; sid:5023351; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - Punycode COM ore DK domain used in certicifate"; flow:to_server,established; ssl_state:client_hello; pcre:"/xn--[a-z0-9\-]{1,256}(.com|.dk)/i"; reference:url,www.xudongz.com/blog/2017/idn-phishing; reference:url,networkforensic.dk; metadata:18042017; classtype:bad-unknown; sid:5023352; rev:1;)
#
#
# NF Unsupported remote web-server - SIGS number range: 5023361 - 5023400
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 1.0 used by remote web-server - Windows NT 3.51"; flow:from_server,established; content:"Server: Microsoft-IIS/1.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023361; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 2.0 used by remote web-server - Windows NT 4.0"; flow:from_server,established; content:"Server: Microsoft-IIS/2.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023362; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 3.0 used by remote web-server - Windows NT 4.0 SP2"; flow:from_server,established; content:"Server: Microsoft-IIS/3.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023363; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 4.0 used by remote web-server - Windows NT 4.0 option pack"; flow:from_server,established; content:"Server: Microsoft-IIS/3.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023364; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 5.0 used by remote web-server - Windows 2000"; flow:from_server,established; content:"Server: Microsoft-IIS/5.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023365; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 5.1 used by remote web-server - Windows XP"; flow:from_server,established; content:"Server: Microsoft-IIS/5.1"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023366; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 6.0 used by remote web-server - Windows 2003"; flow:from_server,established; content:"Server: Microsoft-IIS/6.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023367; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 7.0 used by remote web-server - Windows Server 2008"; flow:established; content:"Server: Microsoft-IIS/7.0"; nocase; http_header; classtype:not-suspicious; metadata:160822; sid:5023368; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Unsupported IIS 7.5 used by remote web-server - Windows 7"; flow:established; content:"Server: Microsoft-IIS/7.5"; nocase; http_header; classtype:not-suspicious; metadata:160822; sid:5023369; rev:1;)
#
#
# NF Unsupported local web-server - SIGS number range: 5023401 - 5023450
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 1.0 used by local web-server - Windows NT 3.51"; flow:to_client,established; content:"Server: Microsoft-IIS/1.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023401; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 2.0 used by local web-server - Windows NT 4.0"; flow:to_client,established; content:"Server: Microsoft-IIS/2.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023402; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 3.0 used by local web-server - Windows NT 4.0 SP2"; flow:to_client,established; content:"Server: Microsoft-IIS/3.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023403; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 4.0 used by local web-server - Windows NT 4.0 option pack"; flow:to_client,established; content:"Server: Microsoft-IIS/3.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023404; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 5.0 used by local web-server - Windows 2000"; flow:to_client,established; content:"Server: Microsoft-IIS/5.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023405; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 5.1 used by local web-server - Windows XP"; flow:to_client,established; content:"Server: Microsoft-IIS/5.1"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023406; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 6.0 used by local web-server - Windows 2003"; flow:to_client,established; content:"Server: Microsoft-IIS/6.0"; nocase; http_header; classtype:not-suspicious; metadata:22042017; sid:5023407; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 7.0 used by local web-server - Windows Server 2008"; flow:established; content:"Server: Microsoft-IIS/7.0"; nocase; http_header; classtype:not-suspicious; metadata:160822; sid:5023408; rev:1;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"NF - Unsupported IIS 7.5 used by local web-server - Windows 7"; flow:established; content:"Server: Microsoft-IIS/7.5"; nocase; http_header; classtype:not-suspicious; metadata:160822; sid:5023409; rev:1;)
#
#
# NF Lan-Turtle - SIGS number range: 5023451 - 5023500
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Lan-Turtle - Hacking device - update check"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/updates/"; nocase; http_uri; content:"lanturtle.com"; nocase; http_header; content:"Wget"; nocase; http_header; reference:url,networkforensic.dk; metadata:16042017; classtype:misc-activity; sid:5023451; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Lan-Turtle - Hacking device - update download"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/turtle-2.bin"; nocase; http_uri; content:"downloads.lanturtle.com"; nocase; http_header; content:"Wget"; nocase; http_header; reference:url,networkforensic.dk; metadata:16042017; classtype:misc-activity; sid:5023452; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Lan-Turtle - Hacking device - Modules list"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/modules/"; nocase; http_uri; content:"lanturtle.com"; nocase; http_header; content:"Wget"; nocase; http_header; reference:url,networkforensic.dk; metadata:16042017; classtype:misc-activity; sid:5023453; rev:1;)
alert icmp $HOME_NET any -> 104.24.106.195 any (msg:"NF - Lan-Turtle - Ping home - Data in Data field"; itype:8; icode:0; dsize:56; reference:url,networkforensic.dk; metadata:16042017; classtype:misc-activity; sid:5023454; rev:1;)
#
# Lan-Turtle - NTP Domains (Doamins are used by many vendors - Only use if you can control you NTP settings in your environment)
alert udp $HOME_NET any -> any 53 (msg:"NF - Lan-Turtle - Hacking device default NTP domain - 0.openwrt.pool.ntp.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|0|07|openwrt|04|pool|03|ntp|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:28042017; classtype:misc-activity; sid:5023455; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Lan-Turtle - Hacking device default NTP domain - 1.openwrt.pool.ntp.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|1|07|openwrt|04|pool|03|ntp|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:28042017; classtype:misc-activity; sid:5023456; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Lan-Turtle - Hacking device default NTP domain - 2.openwrt.pool.ntp.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|2|07|openwrt|04|pool|03|ntp|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:28042017; classtype:misc-activity; sid:5023457; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Lan-Turtle - Hacking device default NTP domain - 3.openwrt.pool.ntp.org"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|01|3|07|openwrt|04|pool|03|ntp|03|org"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:28042017; classtype:misc-activity; sid:5023458; rev:1;)
#
#
# Trojan information stealer - SIGS number range: 5023501 - 5023600
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - TROJAN Vidar information stealer - Data upload"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b 20|name=|22|hwid|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|os|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|platform|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|user|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|cccount|22|"; http_client_body; nocase; reference:url,networkforensic.dk; metadata:27022019; classtype:trojan-activity; sid:5023501; rev:1;) 
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Raccoon Stealer - No alert"; flow:to_server,established; content:"POST"; depth:4; nocase; http_method; content:"/gate/log.php"; http_uri; nocase; content:"params="; nocase; flowbits:set,NF-Raccoon; flowbits:noalert; reference:url,networkforensic.dk; metadata:26052020; classtype:trojan-activity; sid:5023502; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Trojan Raccoon Stealer C2"; flow:from_server,established; content:"200"; http_stat_code; content:"file_handler"; flowbits:isset,NF-Raccoon; reference:url,networkforensic.dk; metadata:26052020; classtype:trojan-activity; sid:5023503; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"Trojan LokiBot - Malware User Agent)"; flow:established,to_server; content:"User-Agent|3A 20|Mozilla/4.08"; http_header; nocase; content:"Charon"; content:"Inferno"; nocase; reference:url,networkforensic.dk; metadata:12092020; classtype:trojan-activity; sid:5023504; rev:1;)
#
#
# NF EternalBlue attacks - SIGS number range: 5023601 - 5023700
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Possible infection - Used by EternalBlue exploitation attempt - Nitol"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"/taskmgr.exe"; nocase; http_uri; reference:url,fireeye.com/blog/threat-research/2017/05/threat-actors-leverage-eternalblue-exploit-to-deliver-non-wannacry-payloads.html; reference:url,networkforensic.dk; metadata:03062017; classtype:misc-activity; sid:5023601; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Known C2 domain - Used by EternalBlue exploitation attempt - Nitol - beiyeye.401hk.com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|07|beiyeye|05|401hk|03|com"; fast_pattern; nocase; distance:0; reference:url,fireeye.com/blog/threat-research/2017/05/threat-actors-leverage-eternalblue-exploit-to-deliver-non-wannacry-payloads.html; reference:url,networkforensic.dk; metadata:03062017; classtype:misc-activity; sid:5023602; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - Known C2 domain - Used by EternalBlue exploitation attempt - Gh0st - bj6po.a1free9bird.com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|bj6po|0b|a1free9bird|03|com"; fast_pattern; nocase; distance:0; reference:url,fireeye.com/blog/threat-research/2017/05/threat-actors-leverage-eternalblue-exploit-to-deliver-non-wannacry-payloads.html; reference:url,networkforensic.dk; metadata:03062017; classtype:misc-activity; sid:5023603; rev:1;)
alert tcp $HOME_NET any -> 120.209.40.157 8880 (msg:"NF - Connection to known C2 - Used by EternalBlue exploitation attempt - Nitol"; flow:to_server,established; reference:url,fireeye.com/blog/threat-research/2017/05/threat-actors-leverage-eternalblue-exploit-to-deliver-non-wannacry-payloads.html; reference:url,networkforensic.dk; metadata:03062017; classtype:misc-activity; sid:5023604; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"NF - WannaCry.A Killswitch Domain - Infected host detected"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|29|iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea|03|com"; nocase; reference:url,networkforensic.dk; metadata:16032018; classtype:trojan-activity; sid:5023605; rev:1;)
#
#
# NF Unencrypted traffic on port 443 - SIGS number range: 5023701 - 5023750
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (POST)"; flow:to_server,established; content:"POST "; depth:5; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023701; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (HEAD)"; flow:to_server,established; content:"HEAD "; depth:5; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023702; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (PROPFIND)"; flow:to_server,established; content:"PROPFIND "; depth:9; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023704; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (OPTIONS)"; flow:to_server,established; content:"OPTIONS "; depth:8; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023705; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (PUT)"; flow:to_server,established; content:"PUT "; depth:4; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023706; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (DELETE)"; flow:to_server,established; content:"DELETE "; depth:7; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023707; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (TRACE)"; flow:to_server,established; content:"TRACE "; depth:6; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023708; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - HTTP traffic on port 443 (CONNECT)"; flow:to_server,established; content:"CONNECT "; depth:8; reference:url,networkforensic.dk; classtype:bad-unknown; metadata:25052017; sid:5023709; rev:1;)
#
#
# NF OS-Windows - SIGS number range: 5023751 - 5023800
alert tcp any any -> any 445 (msg:"NF - OS-WINDOWS - SMBleed exploit payload detected"; content:"|FC|SMB"; depth:4; offset:4; content:"|60 0a 46 02 fe 53 4d 42 40 00|"; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1206; reference:url,networkforensic.dk; reference:cve,2020-1206; classtype:attempted-admin; sid:5023751; rev:1;)
#
#
# NF DNSMessenger - SIGS number range: 5023801 - 5023850
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - DNSMessenger DNS TXT response"; content:"|00 10 00 01 c0 0c|"; content:"|24 65 2b 3d 60|"; reference:url,blog.talosintelligence.com/2017/03/dnsmessenger.html; reference:url,networkforensic.dk; metadata:16062017; classtype:misc-activity; sid:5023801; rev:1;)
#
#
# QuakBOT Trojan (Qbot) - SIGS number range: 5023851 - 5024050
alert tcp $HOME_NET 30000: -> $EXTERNAL_NET 30000: (msg:"NF - QuakBot Flow on high ports - Check host"; flow:to_server,established; content:"|01 07 00 00 00 00 04 02 00 00|"; reference:url,networkforensic.dk; metadata:19022020; classtype:trojan-activity; sid:5023851; rev:1;)
#
#
# NF Remote Desktop - Terminal Service - SIGS number range: 5024151 - 5024200
alert tcp $EXTERNAL_NET any -> $HOME_NET !3389 (msg:"NF - POLICY - Remote Desktop connection request on non-standard port"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|e0 00 00 00 00 00|"; offset:5; depth:6; content:"Cookie|3a| mstshash="; fast_pattern; reference:url,networkforensic.dk; classtype:policy-violation; metadata:12112017; sid:5024151; rev:1;)
alert tcp any [21,22,23,25,53,80,443,8080] -> any !3389 (msg:"NF - RDP - HANDSHAKE [Tunneled msts]"; dsize:<65; content:"|03 00 00|"; depth:3; content:"|e0|"; distance:2; within:1; content:"Cookie: mstshash="; distance:5; within:17; reference:url,fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html; reference:url,networkforensic.dk; metadata:24012019; classtype:trojan-activity; sid:5024152; rev:1;)
alert tcp any [21,22,23,25,53,80,443,8080] -> any !3389 (msg:"NF - RDP - HANDSHAKE [Tunneled]"; flow:established; content:"|c0 00|Duca"; depth:250; content:"rdpdr"; content:"cliprdr"; reference:url,fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html; reference:url,networkforensic.dk; metadata:24012019; classtype:trojan-activity; sid:5024153; rev:1;)
# 
#
# Hancitor Malware - SIGS number range: 5024201 - 5024300
#alert udp $HOME_NET any -> 208.67.222.222 53 (msg:"NF - POLICY - myip.opendns.com lookup - Used by Hancitor malware"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|myip|07|opendns|03|com|00|"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:15102019; classtype:trojan-activity; sid:5024201; rev:1;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Hancitor malware - POST"; flow:to_server,established; content:"POST"; depth:4; nocase; http_method; uricontent:"/4/forum.php"; nocase; content:"|47 55 49 44|"; reference:url,networkforensic.dk meadata:15102019; classtype:trojan-activity; sid:5024202; rev:1;)
#
#
# NF The Domain is seized by The Danish State Prosecutor - SIGS number range: 5024301 - 5024400
alert tcp $HOME_NET any -> 194.239.23.178 80 (msg:"NF - The Domain is seized by The Danish State Prosecutor - Sinkhole"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; uricontent:"/images/beslag.jpg"; nocase; reference:url,networkforensic.dk; classtype:policy-violation; metadata:12122017; sid:5024301; rev:1;)
alert tcp $HOME_NET any -> 194.239.23.178 80 (msg:"NF - The Domain is seized by The Danish State Prosecutor - Sinkhole"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; uricontent:"/Images/logopoliti.gif"; nocase; reference:url,networkforensic.dk; classtype:policy-violation; metadata:12122017; sid:5024302; rev:1;)
#
#
# NF CPU Miner Trojans - SIGS number range: 5024401 - 5024500
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Monero CPU Miner Trojan"; flags:PA; flow:established,to_server; dsize:<300; content:"|22|XMRig/"; reference:url,networkforensic.dk; metadata:16122017; classtype:trojan-activity; sid:5024401; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - CPU Miner Multi Trojan"; flags:PA; flow:established,to_server; dsize:<300; content:"|22|cpuMiNer-Multi/"; reference:url,networkforensic.dk; metadata:16122017; classtype:trojan-activity; sid:5024402; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - XMRig CPU Miner - Trojan checkin"; flags:PA; dsize:<300; content:"|22 58 4d 52 69 67 2f 32|"; reference:url,networkforensic.dk; metadata:05022018; classtype:trojan-activity; sid:5024403; rev:1;)
#
#
# NF Intel Active Management Technology - SIGS number range: 5024501 - 5024600
alert tcp any 1024: -> $HOME_NET [16992] (msg:"NF - Intel Active Management Technology - Request"; flow:to_server,established;  content:"GET"; depth:3; content:"/sw.gif"; content:"Authorization|3a 20|Digest"; content:"username=|22|"; distance:0; content:"response="; distance:0; flowbits:set,NF-IAMT; flowbits:noalert; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024501; rev:2;)
alert tcp $HOME_NET [16992] -> any 1024: (msg:"NF - Intel Active Management Technology - Web-login success"; flow:to_client,established; content:"200"; content:"OK"; content:"Server|3a 20|Intel|28|R|29 20|Active|20|Management|20|Technology"; flowbits:isset,NF-IAMT; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024502; rev:2;)
alert tcp any 1024: -> $HOME_NET [16992] (msg:"NF - Intel Active Management Technology - Platform Solution Manager - Request"; flow:to_server,established; content:"POST"; depth:4; content:"/wsman"; content:"Authorization|3a 20|Digest"; content:"username=|22|"; distance:0; content:"response="; distance:0; flowbits:set,NF-PSM; flowbits:noalert; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024503; rev:2;)
alert tcp $HOME_NET [16992] -> any 1024: (msg:"NF - Intel Active Management Technology - Platform Solution Manager login success"; flow:to_client,established; detection_filter:track by_dst, count 24, seconds 5; content:"200"; content:"OK"; content:"Server|3a 20|Intel|28|R|29 20|Active|20|Management|20|Technology"; flowbits:isset,NF-PSM; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024504; rev:2;)
alert tcp $HOME_NET [16994] -> any 1024: (msg:"NF - Intel AMT Redirection/TCP - VNC protocol detection"; flow:established; content:"RFB 0"; depth:5; flowbits:set,NF-AMTVNC; flowbits:noalert; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024505; rev:1;)
alert tcp $HOME_NET [16994] -> any 1024: (msg:"NF - Intel AMT Redirection/TCP to VNC Connection established"; flow:established; content:"Intel|28|r|29 20|AMT KVM"; flowbits:isset,NF-AMTVNC; reference:url,networkforensic.dk; metadata:15012018; classtype:bad-unknown; sid:5024506; rev:1;)
#
#
# NF SSL / TLS rules Policy - SIGS number range: 5024601 - 5024700
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"NF - Signed TLS Certificate with md5 With RSA Encryption"; flow:established,from_server; content:"|16 03 01|"; depth:3; content:"|02|"; distance:2; within:1; byte_jump:3,0,relative,big; content:"|16 03 01|"; within:3; content:"|0b|"; distance:2; within:2; content:"|30 82|"; distance:9; within:2; content:"|30 82|"; distance:2; within:2; content:"|a0 03 02 01 02 02|"; distance:2; within:6; byte_jump:1,0,relative,big; content:"|30 0d 06 09 2a 86 48 86 f7 0d 01 01 04 05 00|"; within:15; reference:url,networkforensic.dk; metadata:02022017; classtype:policy-violation; sid:5024601; rev:1;)
#
#
# NF General rules for NMAP identification - SIGS number range: 5024701 - 5024800
#alert icmp $HOME_NET any -> any any (msg:"NF - ICMP Echo Reply undefined code"; detection_filter:track by_dst, count 3, seconds 5; icode:0; itype:0; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024701; rev:1;)
#alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - SCAN PING NMAP"; dsize:0; itype:8; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024702; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5800:5820 (msg:"NF - SCAN Potential VNC Scan 5800-5820"; flags:S,12; detection_filter: track by_src, count 5, seconds 60; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024703; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NF - SCAN NMAP SIP Version Detect OPTIONS Scan"; flow:established,to_server; content:"OPTIONS sip|3A|nm SIP/"; depth:19; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024704; rev:1;)
alert udp $EXTERNAL_NET 10000: -> $HOME_NET 10000: (msg:"NF - SCAN NMAP OS Detection Probe"; dsize:300; content:"CCCCCCCCCCCCCCCCCCCC"; fast_pattern:only; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; depth:255; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; within:45; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024705; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - SCAN nmap fingerprint attempt"; flags:SFPU; flow:stateless; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024706; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - SCAN nmap XMAS"; flow:stateless; flags:FPU,12; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024707; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"NF - SCAN Potential SSH Scan"; flags:S,12; detection_filter: track by_src, count 5, seconds 60; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024708; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)"; flow:to_server,established; content:"User-Agent|3a| Mozilla/5.0 (compatible|3b| Nmap Scripting Engine"; fast_pattern:38,20; http_header; nocase; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024709; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NF - SCAN Nmap Scripting Engine User-Agent Detected (Nmap NSE)"; flow:to_server,established; content:"User-Agent|3a| Nmap NSE"; http_header; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024710; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5060:5061 (msg:"NF - SCAN NMAP SIP Version Detection Script Activity"; content:"Via|3A| SIP/2.0/TCP nm"; content:"From|3A| <sip|3A|nm@nm"; within:150; fast_pattern; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024711; rev:1;)
# (Can be noice) alert udp $HOME_NET 137 -> $EXTERNAL_NET any (msg:"NF - SCAN NBTStat Query Response to External Destination, Possible Windows Network Enumeration"; content:"|20 43 4b 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 00 00 21|"; depth:55; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024712; rev:2;)
# Noisy - But detection is right evry time - Disable on external sensors - -  alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - SCAN NMAP -sS 1024 Window"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:1024; detection_filter:track by_dst, count 1, seconds 60; reference:url,networkforensic.dk; metadata:22122017; classtype:network-scan; sid:5024713; rev:1;)
#
#
# NF SSH - SIGS number range: 5024801 - 5024900
alert tcp $EXTERNAL_NET any -> $HOME_NET !22 (msg:"NF - SSH connection to non-standard port"; flow:to_server,established; detection_filter:track by_dst, count 1, seconds 10; content:"SSH-"; nocase; depth:4; reference:url,networkforensic.dk; metadata:24122017; classtype:misc-attack; sid:5024801; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"NF - SSH connection established"; flow:to_server,established; detection_filter:track by_dst, count 1, seconds 10; content:"SSH-"; nocase; depth:4; reference:url,networkforensic.dk; metadata:24122017; classtype:misc-attack; sid:5024802; rev:1;)
alert tcp any !22 -> any !22 (msg:"NF - POLICY - SSH Client detected on non SSH standard port"; flow:to_server,established; content:"ssh-"; nocase; depth:4; reference:url,networkforensic.dk; metadata:08092018; classtype:misc-activity; sid:5024803; rev:1;)
#
#
# NF x509 covert channel - SIGS number range: 5024901 - 5024950
alert tcp any any -> any any (msg:"NF - Abnormal x509v3 SubjectKeyIdentifier extension"; dsize:>768; content:"|16 03|"; depth:2; content:"|06 03 55 1d 0e 04|"; offset:150; pcre:"/\x06\x03\x55\x1d\x0e\x04.\x04[^\x08\x10\x14\x20\x30\x40]/"; reference:url,networkforensic.dk; reference:url,fidelissecurity.com/threatgeek/2018/02/exposing-x509-vulnerabilities; metadata:07022018; classtype:misc-attack; sid:5024901; rev:1;)
alert tcp any any -> any any (msg:"NF - Abnormal very long x509v3 SubjectKeyIdentifier extension"; dsize:>768; content: "|16 03|"; depth:2; content:"|06 03 55 1d 0e 04|"; offset:150; pcre:"/\x06\x03\x55\x1d\x0e\x04[\x80-\xff]/"; reference:url,networkforensic.dk; reference:url,fidelissecurity.com/threatgeek/2018/02/exposing-x509-vulnerabilities; metadata:07022018; classtype:misc-attack; sid:5024902; rev:1;)
#
#
# NF Test Rules - SIGS number range: 5024951 - 5025000
alert udp any any -> any 53 (msg:"NF - TEST RULE - NOT HARMFULL - skod.dk DNS Request"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|skod|02|dk"; fast_pattern; nocase; distance:0; metadata:23102015; classtype:not-suspicious; sid:5024951; rev:2;)
alert udp any any -> any 53 (msg:"NF - TEST RULE - NOT HARMFULL - snot.dk DNS Request"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|04|snot|02|dk"; fast_pattern; nocase; distance:0; metadata:23102015; classtype:not-suspicious; sid:5024952; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - TEST RULE - NOT HARMFULL - skod.dk - Web access"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"skod.dk"; nocase; http_header; metadata:23102015; classtype:not-suspicious; sid:5024953; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - TEST RULE - NOT HARMFULL - snot.dk - Web access"; flow:to_server,established; content:"GET"; depth:3; nocase; http_method; content:"snot.dk"; nocase; http_header; metadata:23102015; classtype:not-suspicious; sid:5024954; rev:2;)
#
#
# Team-Cymru - Malware hash lookup - SIGS number range: 5025001 - 5025050
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - Team-Cymru - DNS TXT Response - Hash known"; content:"|81 82|"; pcre:"/[0-9a-z]{40}\x07malware\x04hash\x05cymru\x03com/"; reference:url,networkforensic.dk; metadata:04092019; classtype:bad-unknown; sid:5025001; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"NF - Team-Cymru - DNS TXT Response - Hash not known"; content:"|81 83|"; offset:2; depth:4; pcre:"/[0-9a-z]{40}\x07malware\x04hash\x05cymru\x03com/"; reference:url,networkforensic.dk; metadata:04092019; classtype:not-suspicious; sid:5025002; rev:1;)
#
#
# NF Bitmessage - SIGS number range: 5025051 - 5025100
alert tcp $HOME_NET 8000: -> $EXTERNAL_NET 1024: (msg:"NF - Vulnerable 0.6.2 version of P2P Bitmessage running in the network"; flow:to_server,established; content:"|2f|PyBitmessage:0.6.2|2f|"; reference:url,reddit.com/r/bitmessage/comments/7xaplc/in_case_you_didnt_notice_update_pybm_right_now; reference:url,networkforensic.dk; metadata:17022018; classtype:misc-activity; sid:5025051; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - P2P Bitmessage domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/bootstrap[0-9]{4}\x0abitmessage\x03org/i"; reference:url,networkforensic.dk; metadata:17022018; classtype:policy-violation; sid:5025052; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - P2P Bitmessenger running in the network"; flow:to_server,established; detection_filter:track by_src, count 5, seconds 30; content:"|2f|PyBitmessage|3a|"; reference:url,bitmessage.org; reference:url,networkforensic.dk; metadata:17022018; classtype:policy-violation; sid:5025053; rev:1;)
#
#
# NF GoPhish Phishing Tool - SIGS number range: 5025101 - 5025150
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"NF - Possible Phishing Tracker via Get GoPhish Phishing Tool"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"/track?rid="; http_uri; fast_pattern; pcre:"/\/track\?rid=[a-z0-9]{7,64}/iU"; reference:url,getgophish.com; reference:url,networkforensic.dk; metadata:25022018; classtype:misc-attack; sid:5025101; rev:1;)
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"NF - Successful Phishing Attempt via Get GoPhish Phishing Tool - User submitted password"; flow:to_server,established; content:"POST"; depth:4; http_method; content:"/?rid="; http_header; fast_pattern; pcre:"/\/\?rid=[a-z0-9]{7,64}/iU"; content:"&password="; reference:url,getgophish.com; reference:url,networkforensic.dk; metadata:25022018; classtype:misc-attack; sid:5025102; rev:1;)
#   
#
# Remote management software - SIGS number range: 5025151 - 5025200
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - AnyDesk Client - Outbound Connection - TLS client keyx"; ssl_state:client_keyx; content:"AnyDesk Client"; reference:url,networkforensic.dk; metadata:25052019; classtype:policy-violation; sid:5025151; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - AnyDesk - Replay domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/relay-[a-z0-9]{8}\x03net\x07anydesk\x03com/i"; reference:url,networkforensic.dk; metadata:25052019; classtype:policy-violation; sid:5025152; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - AnyDesk - BOOT domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/boot-[0-9]{2}\x03net\x07anydesk\x03com/i"; reference:url,networkforensic.dk; metadata:25052019; classtype:policy-violation; sid:5025153; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Splashtop remote - GET "; flow:to_server,established; content:"GET"; depth:3; http_method; content:"User-Agent|3a 20|SSU/3"; nocase; http_header; content:"|0d 0a|Host|3a| sdrs.splashtop.com"; http_header; nocase; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025154; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Splashtop remote - POST Data"; flow:to_server,established; content:"POST"; depth:4; content:"User-Agent|3a 20|SSU|0d 0a|"; nocase; http_header; content:"|0d 0a|Host|3a| ds1.devicevm.com"; http_header; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025155; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Splashtop remote - GET Binary data"; flow:to_server,established; content:"GET"; depth:3; content:"User-Agent|3a 20|SSU/1.5"; nocase; http_header; content:"|0d 0a|Host|3a| sn.splashtop.com"; http_header; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025156; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - Splashtop remote - Used by Conti - API GET"; flow:to_server,established; content:"GET"; depth:3; content:"/api/fulong"; http_uri; content:"User-Agent|3a 20|SRC/1."; nocase; http_header; content:"|0d 0a|Host|3a| st2-v3-dc.splashtop.com"; http_header; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025157; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - ScreenConnect Client setup"; flow:to_server,established; content:"relay.screenconnect.com"; nocase; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025158; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - Atera Remote agent connection"; flow:to_server,established; ssl_state:client_hello; content:"agent-api.atera.com"; reference:url,networkforensic.dk; metadata:01032022; classtype:policy-violation; sid:5025159; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - Teamviewer Server domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/server[0-9]{3,5}\x0ateamviewer\x03com/i"; reference:url,networkforensic.dk; metadata:05062016; classtype:policy-violation; sid:5025160; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - Teamviewer Master domain lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; pcre:"/master[0-9]{1,2}\x0ateamviewer\x03com/i"; reference:url,networkforensic.dk; metadata:05062016; classtype:policy-violation; sid:5025161; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5938 (msg:"NF - POLICY - Teamviewer outbound connection V1 - Client to Server"; flow:to_server,established; dsize:37<>86; content:"|17 24|"; depth:2; reference:url,networkforensic.dk; metadata:05062016; classtype:policy-violation; sid:5025162; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - POLICY - radmin - Remote management tool - connection request"; flow:to_server,established; content:"|01 00 00 00 05 00 00 02|''|02 00 00 00|"; depth:14; flowbits:set,NFRadmin3login; flowbits:noalert; reference:url,networkforensic.dk; metadata:03032022; classtype:policy-violation; sid:5025163; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - POLICY - radmin - Remote management tool - connection established"; flow:to_client,established; flowbits:isset,NFRadmin3login; content:"|01 00 00 00 05 00 00 00|''|00 00 00 00|"; depth:14; reference:url,networkforensic.dk; metadata:03032022; classtype:policy-violation; sid:5025164; rev:1;)
alert tcp $EXTERNAL_NET 5665 -> $HOME_NET 1024: (msg:"NF - POLICY - AeroAdmin - Remote management tool - Auth"; flags:PA; dsize:9<>30; content:"|05 00 00 00|"; reference:url,networkforensic.dk; metadata:23102022; classtype:policy-violation; sid:5025165; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - AnyViewer - Remote management tool - DNS Request to controlserver anyviewer com"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0d|controlserver|09|anyviewer|03|com"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:26102022; classtype:policy-violation; sid:5025166; rev:1;)
alert tcp $EXTERNAL_NET [30192,30193] -> $HOME_NET 1024: (msg:"NF - POLICY - AnyViewer - Remote management tool - Encrypted channel setup"; flow:established; flags:PA; dsize:60<>80; reference:url,networkforensic.dk; metadata:26102022; classtype:policy-violation; sid:5025167; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - GetScreen - Remote management tool - Login"; flow:to_server,established; ssl_state:client_hello; content:"signal.getscreen.me"; reference:url,networkforensic.dk; metadata:26022022; classtype:policy-violation; sid:5025168; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - IperiusRemote - Remote management tool connection outbound - EU"; flow:to_server,established; ssl_state:client_hello; content:"eu-rs1.iperius.com"; reference:url,networkforensic.dk; metadata:27102022; classtype:policy-violation; sid:5025169; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - POLICY - IperiusRemote - Remote management tool connection outbound - US"; flow:to_server,established; ssl_state:client_hello; content:"us-rs1.iperius.com"; reference:url,networkforensic.dk; metadata:27102022; classtype:policy-violation; sid:5025170; rev:1;)
alert udp $HOME_NET 59900: -> [135.125.233.15,15.235.146.205,51.81.220.173] 80 (msg:"NF - INFO - Session Traversal Utilities for NAT (STUN Binding Request) Known to used by IperiusRemote"; detection_filter:track by_src, count 50, seconds 2; content:"|00 01|"; depth:2; content:"|21 12 a4 42|"; distance:2; within:4; reference:url,networkforensic.dk; metadata:27102022; classtype:policy-violation; sid:5025171; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"NF - POLICY - RustDesk - Remote management tool - DNS Request to login server"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|05|rs-ny|08|rustdesk|03|com"; fast_pattern; nocase; distance:0; reference:url,networkforensic.dk; metadata:28102022; classtype:policy-violation; sid:5025172; rev:1;)
alert udp $HOME_NET 1024: -> $EXTERNAL_NET 21116 (msg:"NF - POLICY - RustDesk - Remote management tool - UDP connection";  content:"|7a 53 0a 09 31 35|"; offset:0; depth:6; reference:url,networkforensic.dk; metadata:28102022; classtype:policy-violation; sid:5025173; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET [21115,21116] (msg:"NF - POLICY - RustDesk - Remote management tool - Login"; flow:established; flags:PA; dsize:6; content:"|14 a2 01 02 08 01|"; offset:0; depth:6; reference:url,networkforensic.dk; metadata:28102022; classtype:policy-violation; sid:5025174; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 7615 (msg:"NF - POLICY - ISLonline remote admin tool - No Alert"; flow:established,to_server; content:"MUXV2"; depth:5; nocase; flowbits:set,NF-ISL-RemoteTool; flowbits:noalert; reference:url,networkforensic.dk; metadata:11032023; classtype:policy-violation; sid:5025175; rev:1;)
alert tcp $EXTERNAL_NET 7615 -> $HOME_NET any (msg:"NF - POLICY - ISLonline remote admin tool in use - FlowBit rule"; flow:established,to_Client; content:"|4d 55 58 56 32 0d 0a 50 75 62 6c 69 63|"; rawbytes; flowbits:isset,NF-ISL-RemoteTool; reference:url,networkforensic.dk; metadata:11032023; classtype:policy-violation; sid:5025176; rev:1;)
#
#
# NF Experimental Protocols - SIGS number range: 5025601 - 5025700
alert udp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - POLICY - GQUIC Protocol in use - Not Google - Client Hello Outbound"; flow:to_server; content:"CHLO"; content:"SNI"; content:"UAID"; content:!"gvt2.com"; content:!"google.dk"; content:!"gstatic.com"; content:!"googleapis.com"; content:!"google.com"; content:!"doubleclick.net"; content:!"ytimg.com"; content:!"youtube.com"; content:!"ggpht.com"; content:!"google-analytics.com"; metadata:27042018; reference:url,networkforensic.dk; classtype:unknown; sid:5025601; rev:3;)
alert udp $HOME_NET 1024: -> $EXTERNAL_NET 443 (msg:"NF - QUIC version 1 - Detected"; content:"|00 00 00 01|"; offset:35; depth:45; reference:url,networkforensic.dk; classtype:unknown; metadata:01102021; sid:5025602; rev:1;)
#
#
# NF Powershell rules - SIGS number range: 5025701 - 5025800
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Microsoft Powershell Banner Outbound"; flow:established; content:"Windows PowerShell"; content:"Copyright |28|C|29| 20"; distance:0; content:"Microsoft Corp"; distance:0; reference:url,networkforensic.dk; metadata:05052018; classtype:successful-admin; sid:5025701; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - POLICY - Powershell Command send from outside to client"; flow:established; content:"cmd.exe /c Start /Min PowerShell.exe"; nocase; reference:url,isc.sans.edu/forums/diary/WebLogic+Exploited+in+the+Wild+Again/23617; reference:url,networkforensic.dk; metadata:05052018; classtype:policy-violation; sid:5025702; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - POLICY - PowerShell script over HTTP"; flow:established,to_server; content:".ps1"; http_uri; nocase; content:"GET"; http_method; nocase; content:!"windowsupdate.com"; nocase; http_header; pcre:"/\.ps1\b/Ui"; reference:url,networkforensic.dk; metadata:05052018; classtype:policy-violation; sid:5025703; rev:1;)
#
#
# NF SPAM Attacks - SIGS number range: 5025801 - 5025850
alert tcp $HOME_NET any -> $SMTP_SERVERS 25 (msg:"NF - ZeroFont Attack - Used by Phishing ore SPAMMERS"; flow:to_server,established; detection_filter:track by_src, count 1, seconds 5; content:"|3c|span|20|style|3d 27|font|2d|size|3a|0|27 3e|"; nocase; reference:url,networkforensic.dk; reference:url,www.avanan.com/resources/zerofont-phishing-attack; metadata:21-06-2018; classtype:misc-attack; sid:5025801; rev:1;)
#
#
# NF Netcut APR attackt tool - SIGS number range: 5025851 - 5025900
alert tcp $HOME_NET any -> any 80 (msg:"NF - NetCut ARP attack tool check in - No Alert"; flow:to_server,established; content:"POST"; depth:4; http_method; content:"/netCut/"; http_uri; nocase; fast_pattern; content:"User-Agent|3A 20|netcut"; nocase; http_header; flowbits:set,NF-netcut; flowbits:noalert; reference:url,networkforensic.dk; metadata:25022018; classtype:misc-attack; sid:5025851; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - NetCut ARP attack tool in use - check in OK"; flow:from_server,established; content:"200"; http_stat_code; flowbits:isset,NF-netcut; reference:url,networkforensic.dk; metadata:25022018; classtype:misc-attack; sid:5025852; rev:1;)
#
#
# Known Attacks Against Microsoft Windows  - SIGS number range: 5025901 - 5026000
alert tcp any any -> $HOME_NET 3389 (msg:"NF - BlueKeep RDP Attack - Microsoft Windows RDP MS_T120 channel bind attempt"; flow:to_server,established; content:"MS_T120|00|"; fast_pattern:only; reference:cve,2019-0708; reference:url,www.bleepingcomputer.com/news/security/researchers-demo-poc-for-remote-desktop-bluekeep-rce-exploit; reference:url,networkforensic.dk; metadata:24052019; classtype:attempted-admin; sid:5025901; rev:1;)
#
#
# NF Misc activity - SIGS number range: 5026001 - 5027000
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Request for PNG file - No Alert"; flow:to_server,established; content:"GET"; depth:3; http_method; pcre:"/\/[a-z]{1,10}.png|20|/iU"; flowbits:set,NF-RFPNG; flowbits:noalert; reference:url,networkforensic.dk; metadata:07072018; classtype:not-suspicious; sid:5026001; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Request for PNG file but sending binary file"; flow:from_server,established; content:"200"; http_stat_code; content:"|21|This program cannot be run in DOS mode|2e|"; flowbits:isset,NF-RFPNG; reference:url,networkforensic.dk; metadata:07072018; classtype:misc-activity; sid:5026002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Request for JPG file - No Alert"; flow:to_server,established; content:"GET"; depth:3; http_method; pcre:"/\/[a-z]{1,10}.jpg|20|/iU"; flowbits:set,NF-RFJPG; flowbits:noalert; reference:url,networkforensic.dk; metadata:07072018; classtype:not-suspicious; sid:5026003; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Request for JPG file but sending binary file"; flow:from_server,established; content:"200"; http_stat_code; content:"|21|This program cannot be run in DOS mode|2e|"; flowbits:isset,NF-RFJPG; reference:url,networkforensic.dk; metadata:07072018; classtype:misc-activity; sid:5026004; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - IP address in hostname and GET Request - No Alert"; flow:to_server,established; content:"GET"; depth:3; http_method; pcre:"/Host|3a 20|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}.[0-9]{1,3}/"; flowbits:set,NF-IPHOST; flowbits:noalert; reference:url,networkforensic.dk; metadata:08092018; classtype:not-suspicious; sid:5026005; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Host name with IP address sending exe file"; flow:from_server,established; content:"200"; http_stat_code; content:"|21|This program cannot be run in DOS mode|2e|"; flowbits:isset,NF-IPHOST; reference:url,networkforensic.dk; metadata:08092018; classtype:misc-activity; sid:5026006; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Host name with IP address sending JAR archive"; flow:from_server,established; content:"200"; http_stat_code; content:"Content-Type: application/x-java-archive"; content:"|50 4b|"; flowbits:isset,NF-IPHOST; reference:url,networkforensic.dk; metadata:08092018; classtype:misc-activity; sid:5026007; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Possible Metasploit Payload Common Construct Bind_API (from server)"; flow:from_server,established; file_data; content:"|60 89 e5 31|"; content:"|64 8b|"; distance:1; within:2; content:"|30 8b|"; distance:1; within:2; content:"|0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff|"; distance:1; within:13; content:"|ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2|"; within:15; content:"|52 57 8b 52 10|"; distance:1; within:5; reference:url,networkforensic.dk; metadata:08092018; classtype:trojan-activity; sid:5026008; rev:2;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"NF - User Agent - Python-urllib - Possible protocol stream injection attacks - TCP port 443"; content:"User-Agent|3A 20|Python-urllib/"; reference:url,www.securitynewspaper.com/2016/06/17/advisory-http-header-injection-python-urllib/; reference:url,networkforensic.dk; metadata:08092018; classtype:misc-activity; sid:5026009; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"NF - ZmEu PHP admin attack - Check Webserver logs for 200 ok"; flow:to_server,established; content:"GET"; depth:3; http_method; content:"/w00tw00t"; http_uri; content:"User-Agent|3A 20|ZmEu"; nocase; http_header; reference:url,www.securityweek.com/hacked-mit-server-used-stage-attacks-scan-vulnerabilities; reference:url,networkforensic.dk; metadata:08092018; classtype:attempted-admin; sid:5026010; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Possible Trojan activity - POST to Server with IP and user-agent XmlRpc"; flow:to_server,established; content:"POST"; depth:4; http_method; content:"User-Agent|3A 20|XmlRpc"; nocase; http_header; content:"xml version="; content:"<methodCall>"; nocase; pcre:"/Host|3a 20|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}.[0-9]{1,3}/"; flowbits:set,NF-xmlrpc; flowbits:noalert; reference:url,networkforensic.dk; metadata:13092018; classtype:misc-activity; sid:5026011; rev:2;)
alert tcp any 445 -> any any (msg:"NF - File listning of name SAM hives - SYSTEM hives and ntds.dit AD from same DIR"; flow:established; content:"|53 00 41 00 4d 00|"; content:"|53 00 59 00 53 00 54 00 45 00 4d 00|"; content:"|6e 00 74 00 64 00 73 00 2e 00 64 00 69 00 74 00|"; reference:url,networkforensic.dk; metadata:14092018; classtype:misc-activity; sid:5026012; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Possible Trojan activity - SimpleHTTP Server with IP address sending REG file to internal host"; flow:from_server,established; content:"Server|3A 20|SimpleHTTP"; content:"|00 77 00 73 00 20 00 52 00 65 00 67 00 69 00 73 00 74 00 72 00 79 00 20 00 45 00 64 00 69 00 74 00 6f 00 72 00 20 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 20 00 35 00 2e 00 30 00 30 00 0d|"; flowbits:set,NF-IPHOST;  reference:url,networkforensic.dk; metadata:17092018; classtype:misc-activity; sid:5026013; rev:1;)
alert tcp any any -> any any (msg:"NF - Policy - SMB2 connection containing CISF fileshare information - Check for external IP"; flow:established; content:"|fe 53 4d 42|"; content:"|63 00 69 00 66 00 73 00 2f 00|"; reference:url,networkforensic.dk; metadata:21092018; classtype:misc-activity; sid:5026014; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"NF - Possible Trojan activity - POST to Server and Replay from Server with IP and user-agent XmlRpc - methodResponse - B64 encoded - Check File"; flow:from_server,established; content:"xml version="; nocase; content:"<methodResponse>"; nocase; content:"<base64>"; nocase; flowbits:isset,NF-xmlrpc; reference:url,networkforensic.dk; metadata:110112018; classtype:misc-activity; sid:5026015; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - External IP Address Check on ip-adress.com"; flow:established,to_server; urilen:1; content:"GET"; http_method; content:"/"; http_uri; content:"Host|3a|"; http_header; content:"ip-adress.com|0d 0a|"; fast_pattern; distance:0; http_header; reference:url,networkforensic.dk; metadata:19042019; classtype:misc-activity; sid:5026016; rev:1;)
# (Can be noice)alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Windows OS Submitting USB Metadata to Microsoft"; flow:established,to_server; content:"POST"; http_method; content:"metadata.svc"; http_uri; content:"/DeviceMetadataService/GetDeviceMetadata|22 0d 0a|"; http_header; content:"User-Agent|3a 20|MICROSOFT_DEVICE_METADATA_RETRIEVAL_CLIENT|0d 0a|"; http_header; fast_pattern:12,20; classtype:misc-activity; sid:5026017; rev:1;)
#
#
# NF Empire PowerShell - SIGS number range: 5027101 - 5027200
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - Empire PowerShell Request HTTP Header"; flow:established,to_server; content:"HTTP/1.1|0d 0a|Cookie|3a 20|"; content:"=|0d 0a|User-Agent|3a 20|Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64|3b 20|Trident/7.0|3b 20|rv|3a|11.0) like Gecko|0d 0a|Host|3a|"; fast_pattern:36,20; content:!"Accept"; content:!"Referer|3a 20|"; content:"Connection|3a 20|Keep-Alive|0d 0a|"; content:!"Cache-Control|3a|"; pcre:"/^GET /(?:login\/process\.(?:js|ph)|(?:admin\/get|news)\.ph)p HTTP/"; reference:url,networkforensic.dk; metadata:17102018; classtype:trojan-activity; sid:5027101; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - Empire PowerShell Response HTTP Header"; flow:established,from_server; content:"Server|3a 20|Microsoft-IIS/7.5|0d 0a|"; content:"<html><body><h1>It works!</h1><p>This is the default web page for this server.</p><p>The web server software is running but no content has been added, yet.</p></body></html>"; isdataat:!1,relative; reference:url,networkforensic.dk; metadata:17102018; classtype:trojan-activity; sid:5027102; rev:1;)
#
#
# NF ISAKMP VPN Connection setup outbound - SIGS number range: 5027201 - 5027300
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows 2000"; content:"|00 00 00 02|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027201; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows XP"; content:"|00 00 00 03|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027202; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows Server 2003"; content:"|00 00 00 04|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027203; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows Vista"; content:"|00 00 00 05|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027204; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows 7"; content:"|00 00 00 07|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027205; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows 7 SP2 - Windows Server 2008 / 2008 R2"; content:"|00 00 00 08|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027206; rev:1;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"NF - ISAKMP VPN Connection setup from host to outbound destination - Windows 8 / 8.1 - Windows Server 2012 / 2012 R2 - Windows 10 - Windows Server 2016"; content:"|00 00 00 09|"; reference:url,networkforensic.dk; metadata:29112018; classtype:policy-violation; sid:5027207; rev:1;)
alert udp $EXTERNAL_NET 4500 -> $HOME_NET 4500 (msg:"NF - ESP VPN Connection setup from outbound destination - Encapsulation of IPsec Packets - Windows 8 to 2016"; content:"|00 00 00 09|"; detection_filter: track by_src, count 1, seconds 30; reference:url,networkforensic.dk; metadata:05102019; classtype:policy-violation; sid:5027208; rev:2;)
#
#
# NF Case infected PDFescape - SIGS number range: 5027301 - 5027330
#alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - PDFescape software running"; flow:from_client,established; content:"POST"; depth:4; nocase; http_method; content:"/Service.asmx"; nocase; http_uri; content:"User-Agent|3a 20|VCSoapClient"; nocase; http_header; content:"Host: update.pdfescape.com"; nocase; http_header; reference:url,gbhackers.com/evil-clone-attack-legitimate-pdf-software; reference:url,networkforensic.dk; metadata:13022019; classtype:policy-violation; sid:5027301; rev:1;)
#alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - POLICY - Infected PDFescape installer - BitCoin Miner"; content:"HEAD"; depth:4; nocase; http_method; content:"/pdfescape/x64/module/main"; nocase; http_uri; content:"Host: vps11240.hyperhost.name"; nocase; http_header; reference:url,gbhackers.com/evil-clone-attack-legitimate-pdf-software; reference:url,networkforensic.dk; metadata:13022019; classtype:trojan-activity; sid:5027302; rev:1;)
#alert udp $HOME_NET any -> any 53 (msg:"NF - POLICY - DNS Query to Monerohash.com - BitCoin Mining"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0a|monerohash|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,networkforensic.dk; metadata:13022019; classtype:policy-violation; sid:5027303; rev:1;)
#alert tcp $HOME_NET any -> [107.191.99.95,107.191.99.227] [80,3333] (msg:"NF - Connections to known Bitcoin mining pool - Monerohash"; flow:from_client,established; detection_filter:track by_dst, count 1, seconds 30; reference:url,gbhackers.com/evil-clone-attack-legitimate-pdf-software; reference:url,networkforensic.dk; metadata:13022019; classtype:policy-violation; sid:5027304; rev:1;)
#
#
# NF Citrix explot - SIGS number range: 5027331 - 5027340
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - Citrix ADC Exploit attempt"; content:"POST"; depth:4; http_method; content:"NSC_USER:"; fast_pattern; content:"NSC_USER:"; http_header; content:"/../"; http_header; content:"NSC_NONCE:"; http_header; content:".pl"; http_uri; content:"/vpns/"; nocase; http_uri; reference:url,networkforensic.dk; reference:cve,2019-19781; metadata:12012020; classtype:web-application-attack; sid:5027331; rev:1;)
#
#
# NF Steam information theft - same as PlugX - SIGS number range: 5027341 - 5027400
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"NF - Steam - Information Theft in DMP files (PlugX)"; flow:from_client,established; content:"POST"; depth:4; nocase; http_method; content:"/submit"; nocase; http_uri; content:"User-Agent|3a 20|Breakpad/1.0"; nocase; http_header; content:"Host: crash.steampowered.com"; nocase; http_header; reference:url,networkforensic.dk; metadata:28112020; classtype:policy-violation; sid:5027341; rev:1;)
#
#
# NF Mindspark browser plug-in malware - SIGS number range: 5027401 - 5027450
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"NF - Mindspark certificate - Check host for browser add-on malware"; flow:to_client,established; ssl_state:server_hello; content:"|77 77 77 2e 6d 69 6e 64 73 70 61 72 6b 2e 63 6f 6d|"; reference:url,networkforensic.dk; metadata:08122020; classtype:misc-activity; sid:5027401; rev:1;)
#
#
# NF Fireeye hacked in Dec 2020 - Red team tool countermeasures - SIGS number range: 5027451 - 5027550
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle USAToday Server]"; flow:from_server,established; content:"{\"navgd\":\"<div class=gnt_n_dd_ls_w><div class=gnt_n_dd_nt>ONLY AT USA TODAY:</div><div class=gnt_n_dd_ls><a class=gnt_n_dd_ls_a href=https://supportlocal.usatoday.com/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027451; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle USAToday Server]"; content:"HTTP/1."; depth:7; content:"Connection: close"; content:"Content-Type: application/json\; charset=utf-8"; content:"Content-Security-Policy: upgrade-insecure-requests"; content:"Strict-Transport-Security: max-age=10890000"; content:"Cache-Control: public, immutable, max-age=315360000"; content:"Accept-Ranges: bytes"; content:"X-Cache: HIT, HIT"; content:"X-Timer: S1593010188.776402,VS0,VE1"; content:"Vary: X-AbVariant, X-AltUrl, Accept-Encoding"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027452; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original Server]"; content:"HTTP/1."; depth:7; content:"Content-Type: text/json|0d 0a|"; content:"Server: Microsoft-IIS/10.0|0d 0a|"; content:"X-Powered-By: ASP.NET|0d 0a|"; content:"Cache-Control: no-cache, no-store, max-age=0, must-revalidate|0d 0a|"; content:"Pragma: no-cache|0d 0a|"; content:"X-Frame-Options: SAMEORIGIN|0d 0a|"; content:"Connection: close|0d 0a|"; content:"{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":17656184060,\"id\":\"\",\"vims\":{\"dtc\":"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027453; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle NYTIMES GET]"; content:"GET"; depth:3; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US,en\;q=0.5"; content:"nyt-a="; content:"nyt-gdpr=0\;nyt-purr=cfh\;nyt-geo=US}"; fast_pattern; content:"|0d 0a|Cookie:"; pcre:"/^GET\s(?:\/ads\/google|\/vi-assets\/static-assets|\/v1\/preferences|\/idcta\/translations|\/v2\/preferences)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027454; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original Stager]"; content:"T "; offset:2; depth:3; content:"Accept: */*"; content:"Accept-Language: en-US"; content:"Accept-Encoding: gzip, deflate"; content:"Cookie: SIDCC=AN0-TYutOSq-fxZK6e4kagm70VyKACiG1susXcYRuxK08Y-rHysliq0LWklTqjtulAhQOPH8uA"; pcre:"/\/api\/v1\/user\/(?:512|124)\/avatar/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027455; rev:1;)
alert tcp any any -> any any (msg:"FireEye tool - Backdoor.HTTP.GORAT.[SID1]"; content:"GET"; depth:3; content:"|0d 0a|Cookie: SID1="; content:!"|0d 0a|Referer:"; content:!"|0d 0a|Accept"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027456; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle MSOffice Server]"; content:"HTTP/1."; depth:7; content:"{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":17656184060,\"id\":\"\",\"vims\":{\"dtc\":\""; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027457; rev:1;)
alert tcp any any -> any 443 (msg:"FireEye tool - Backdoor.SSL.BEACON.[CSBundle Ajax]"; content:"|16 03|"; depth:2; content:"US"; content:"US"; distance:0; content:"ajax.microsoft.com"; content:"ajax.microsoft.com"; distance:0; content:"Seattle"; content:"Seattle"; distance:0; content:"Microsoft"; content:"Microsoft"; distance:0; content:"Information Technologies"; content:"Information Technologies"; distance:0; content:"WA"; content:"WA"; distance:0; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027458; rev:1;)
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[Yelp GET]"; flow:to_server; content:"GET "; depth:4; content:"&parent_request_id="; distance:0; within:256; fast_pattern; content:" HTTP/1"; distance:0; within:1024; content:"|0d 0a|Sec-Fetch-Dest: empty|0d 0a|"; distance:0; within:256; content:"request_origin=user"; offset:0; depth:256; pcre:"/^GET [^\r\n]{0,256}&parent_request_id=(?:[A-Za-z0-9_\/\+\-%]{128,1024})={0,2}[^\r\n]{0,256} HTTP\/1\.[01]/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027459; rev:1;)
alert udp any 53 -> any any (msg:"FireEye tool - Backdoor.DNS.BEACON.[CSBundle DNS]"; content:"|00 01 00 01|"; offset:4; depth:4; content:"|0a|_domainkey"; distance:0; content:"|00 00 10 00 01 c0 0c 00 10 00 01 00 00 00 02 01 00 ff|v=DKIM1\; p="; distance:0; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027460; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle CDN GET]"; content:"GET"; depth:3; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US|0d 0a|"; content:"client-="; content:"\;auth=1}"; content:"Cookie:"; pcre:"/^GET\s(?:\/v1\/queue|\/v1\/profile|\/v1\/docs\/wsdl|\/v1\/pull)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027461; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle USAToday GET]"; content:"GET"; depth:3; content:"Connection: close|0d 0a|"; content:"Accept: */*|0d 0a|"; content:"gnt_ub=86\;gnt_sb=18\;usprivacy=1YNY\;DigiTrust.v1.identity="; content:"%3D\;GED_PLAYLIST_ACTIVITY=W3sidSI6IkZtTWUiLCJ0c2wiOjE1OTMwM\;"; content:"Cookie:"; pcre:"/^GET\s(?:\/USAT-GUP\/user\/|\/entertainment\/|\/entertainment\/navdd-q1a2z3Z6TET4gv2PNfXpaJAniOzOajK7M\.min\.json|\/global-q1a2z3C4M2nNlQYzWhCC0oMSEFjQbW1KA\.min\.json|\/life\/|\/news\/weather\/|\/opinion\/|\/sports\/|\/sports\/navdd-q1a2z3JHa8KzCRLOQAnDoVywVWF7UwxJs\.min\.json|\/tangstatic\/js\/main-q1a2z3b37df2b1\.min\.js|\/tangstatic\/js\/pbjsandwich-q1a2z300ab4198\.min\.js|\/tangstatic\/js\/pg-q1a2z3bbc110a4\.min\.js|\/tangsvc\/pg\/3221104001\/|\/tangsvc\/pg\/5059005002\/|\/tangsvc\/pg\/5066496002\/|\/tech\/|\/travel\/)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027462; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original POST]"; content:"POST"; depth:4; content:"Accept: */*|0d 0a|"; content:"Accept-Language: en-US|0d 0a|"; content:"Accept-Encoding: gzip, deflate|0d 0a|"; content:"{\"locale\":\"en\",\"channel\":\"prod\",\"addon\":\""; pcre:"/^POST\s(?:\/v4\/links\/check-activity\/check|\/v1\/stats|\/gql|\/api2\/json\/check\/ticket|\/1.5\/95648064\/storage\/history|\/1.5\/95648064\/storage\/tabs|\/u\/0\/_\/og\/botguard\/get|\/ev\/prd001001|\/ev\/ext001001|\/gp\/aw\/ybh\/handlers|\/v3\/links\/ping-beat\/check)/"; content:"ses-"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027463; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle MSOffice POST]"; content:"POST /v1/push"; depth:13; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US|0d 0a|"; content:"{\"locale\":\"en\",\"channel\":\"prod\",\"addon\":\""; content:"cli"; content:"l-"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027464; rev:1;)
alert tcp any any -> any [139,445] (msg:"FireEye tool - M.HackTool.SMB.Impacket-Obfuscation.[Service Names]"; content:"|ff 53 4d 42|"; offset:4; depth:4; pcre:"/(?:\x57\x00\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x55\x00\x70\x00\x64\x00\x61\x00\x74\x00\x65\x00\x20\x00\x43\x00\x6f\x00\x6e\x00\x74\x00\x72\x00\x6f\x00\x6c\x00\x20\x00\x53\x00\x65\x00\x72\x00\x76\x00\x69\x00\x63\x00\x65|\x57\x00\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x31\x00\x30\x00\x20\x00\x44\x00\x65\x00\x66\x00\x65\x00\x6e\x00\x64\x00\x65\x00\x72|\x57\x00\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x4c\x00\x69\x00\x63\x00\x65\x00\x6e\x00\x73\x00\x65\x00\x20\x00\x4b\x00\x65\x00\x79\x00\x20\x00\x41\x00\x63\x00\x74\x00\x69\x00\x76\x00\x61\x00\x74\x00\x69\x00\x6f\x00\x6e|\x4f\x00\x66\x00\x66\x00\x69\x00\x63\x00\x65\x00\x20\x00\x33\x00\x36\x00\x35\x00\x20\x00\x50\x00\x72\x00\x6f\x00\x78\x00\x79|\x4d\x00\x69\x00\x63\x00\x72\x00\x6f\x00\x73\x00\x6f\x00\x66\x00\x74\x00\x20\x00\x53\x00\x65\x00\x63\x00\x75\x00\x72\x00\x69\x00\x74\x00\x79\x00\x20\x00\x43\x00\x65\x00\x6e\x00\x74\x00\x65\x00\x72|\x4f\x00\x6e\x00\x65\x00\x44\x00\x72\x00\x69\x00\x76\x00\x65\x00\x20\x00\x53\x00\x79\x00\x6e\x00\x63\x00\x20\x00\x43\x00\x65\x00\x6e\x00\x74\x00\x65\x00\x72|\x42\x00\x61\x00\x63\x00\x6b\x00\x67\x00\x72\x00\x6f\x00\x75\x00\x6e\x00\x64\x00\x20\x00\x41\x00\x63\x00\x74\x00\x69\x00\x6f\x00\x6e\x00\x20\x00\x4d\x00\x61\x00\x6e\x00\x61\x00\x67\x00\x65\x00\x72|\x53\x00\x65\x00\x63\x00\x75\x00\x72\x00\x65\x00\x20\x00\x54\x00\x6f\x00\x6b\x00\x65\x00\x6e\x00\x20\x00\x4d\x00\x65\x00\x73\x00\x73\x00\x61\x00\x67\x00\x69\x00\x6e\x00\x67\x00\x20\x00\x53\x00\x65\x00\x72\x00\x76\x00\x69\x00\x63\x00\x65|\x57\x00\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x20\x00\x55\x00\x70\x00\x64\x00\x61\x00\x74\x00\x65)/R"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027465; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original Stager 2]"; content:"HTTP/1."; depth:7; content:"Content-Type: text/json|0d 0a|"; content:"Server: Microsoft-IIS/10.0|0d 0a|"; content:"X-Powered-By: ASP.NET|0d 0a|"; content:"Cache-Control: no-cache, no-store, max-age=0, must-revalidate|0d 0a|"; content:"Pragma: no-cache|0d 0a|"; content:"X-Frame-Options: SAMEORIGIN|0d 0a|"; content:"Connection: close|0d 0a|"; content:"Content-Type: image/gif"; content:"|01 00 01 00 00 02 01 44 00 3b|"; content:"|ff ff ff 21 f9 04 01 00 00 00 2c 00 00 00 00|"; content:"|47 49 46 38 39 61 01 00 01 00 80 00 00 00 00|"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027466; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle NYTIMES POST]"; content:"POST"; depth:4; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US,en\;q=0.5"; content:"id-"; content:"{\"locale\":\"en\",\"channel\":\"prod\",\"addon\":\""; pcre:"/^POST\s(?:\/track|\/api\/v1\/survey\/embed|\/svc\/weather\/v2)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027467; rev:1;)
alert tcp any any -> any 88 (msg:"FireEye tool - HackTool.TCP.Rubeus.[nonce 2]"; content:"|a7 06 02 04 6C 69 6C 00|"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027468; rev:1;)
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[Yelp Request]"; flow:to_server; content:"T "; depth:5; content:" HTTP/1"; distance:0; within:256; content:"Cookie: hl=en|3b|bse="; distance:0; within:256; fast_pattern; content:"|3b|_gat_global=1|3b|recent_locations|3b|_gat_www=1|3b||0d 0a|"; pcre:"/Cookie: hl=en\x3bbse=(?:[A-Za-z0-9_\/\+\-]{128,1024})={0,2}\x3b_gat_global=1\x3brecent_locations\x3b_gat_www=1\x3b\r\n/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027469; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle MSOffice GET]"; content:"GET"; depth:3; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US|0d 0a|"; content:"sess-="; content:"auth=0\;loc=US}"; content:"Cookie:"; pcre:"/^GET\s(?:\/updates|\/license\/eula|\/docs\/office|\/software-activation)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027470; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original Server 2]"; content:"{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":17656184060,\"id\":\"\",\"vims\":{\"dtc\":"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027471; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle MSOffice POST]"; content:"POST /notification"; depth:18; content:"Accept: */*"; content:"Accept-Encoding: gzip, deflate, br"; content:"Accept-Language: en-US|0d 0a|"; content:"{\"locale\":\"en\",\"channel\":\"prod\",\"addon\":\""; content:"nid"; content:"msg-"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027472; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original GET]"; content:"GET"; depth:3; content:"Accept: */*|0d 0a|"; content:"Accept-Language: en-US|0d 0a|"; content:"Accept-Encoding: gzip, deflate|0d 0a|"; content:"Cookie:"; content:"display-culture=en\;check=true\;lbcs=0\;sess-id="; distance:0; content:"\;SIDCC=AN0-TY21iJHH32j2m\;FHBv3=B"; pcre:"/^GET\s(?:\/api2\/json\/access\/ticket|\/api2\/json\/cluster\/resources|\/api2\/json\/cluster\/tasks|\/en-us\/p\/onerf\/MeSilentPassport|\/en-us\/p\/book-2\/8MCPZJJCC98C|\/en-us\/store\/api\/checkproductinwishlist|\/gp\/cerberus\/gv|\/gp\/aj\/private\/reviewsGallery\/get-application-resources|\/gp\/aj\/private\/reviewsGallery\/get-image-gallery-assets|\/v1\/buckets\/default\/ext-5dkJ19tFufpMZjVJbsWCiqDcclDw\/records|\/v3\/links\/ping-centre|\/v4\/links\/activity-stream|\/wp-content\/themes\/am43-6\/dist\/records|\/wp-content\/themes\/am43-6\/dist\/records|\/wp-includes\/js\/script\/indigo-migrate)/"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027473; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle MSOffice Server]"; flow:from_server,established; content:"{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":17656184060,\"id\":\"\",\"vims\":{\"dtc\":\""; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027474; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle NYTIMES Server]"; flow:from_server,established; content:"{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":17656184060,\"id\":\"\",\"vims\":{\"dtc\":\""; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027475; rev:1;)
alert udp any any -> any 88 (msg:"FireEye tool - HackTool.UDP.Rubeus.[nonce 2]"; content:"|a7 06 02 04 6C 69 6C 00|"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027476; rev:1;)
alert udp any 53 -> any any (msg:"FireEye tool - Backdoor.DNS.BEACON.[CSBundle DNS]"; content:"|00 01 00 01|"; offset:4; depth:4; content:"|03|"; within:15; content:"|0a|_domainkey"; distance:3; within:11; content:"|00 00 10 00 01 c0 0c 00 10 00 01 00 00 00 02 01 00 ff|v=DKIM1\; p="; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027477; rev:1;)
alert tcp any any -> any 88 (msg:"FireEye tool - HackTool.TCP.Rubeus.[nonce]"; content:"|05|"; depth:30; content:"|0a|"; distance:4; within:1; content:"Z"; content:"|6C 69 6C 00|"; within:25; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027478; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle NYTIMES Server]"; content:"HTTP/1."; depth:7; content:"Accept-Ranges: bytes"; content:"Age: 5806"; content:"Cache-Control: public,max-age=31536000"; content:"Content-Encoding: gzip"; content:"Content-Length: 256398"; content:"Content-Type: application/javascript"; content:"Server: UploadServer"; content:"Vary: Accept-Encoding, Fastly-SSL"; content:"x-api-version: F-X"; content:"x-cache: HIT"; content:"x-Firefox-Spdy: h2"; content:"x-nyt-route: vi-assets"; content:"x-served-by: cache-mdw17344-MDW"; content:"x-timer: S1580937960.346550,VS0,VE0"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027479; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"FireEye tool - Backdoor.HTTP.BEACON.[CSBundle Original Server 3]"; content:"{\"alias\":\"apx\",\"prefix\":\"\",\"suffix\":null,\"suggestions\":[],\"responseId\":\"15QE9JX9CKE2P\",\"addon\": \""; content:"\",\"shuffled\":false}"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027480; rev:1;)
alert udp any any -> any 88 (msg:"FireEye tool - HackTool.UDP.Rubeus.[nonce]"; content:"|05|"; depth:30; content:"|0a|"; distance:4; within:1; content:"Z"; content:"|6C 69 6C 00|"; within:25; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027481; rev:1;)
alert tcp any any -> any any (msg:"FireEye tool - Backdoor.HTTP.GORAT.[POST]"; content:"POST / HTTP/1.1"; depth:15; content:"Connection: upgrade"; content:"|0d 0a|Upgrade: tcp/1|0d 0a|"; content:!"|0d 0a|Referer:"; content:!"|0d 0a|Accept"; content:!"|0d 0a|Cookie:"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027482; rev:1;)
alert tcp any any -> any any (msg:"FireEye tool - HackTool.TCP.Rubeus.[User32LogonProcesss]"; flow:to_server; content:"User32LogonProcesss"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027483; rev:1;)
alert tcp any any -> any any (msg:"FireEye tool - Backdoor.HTTP.GORAT.[Build ID]"; content:"aqlKZ7wjzg0iKM00E1WB/jq9_RA46w91EKl9A02Dv/nbNdZiLsB1ci8Ph0fb64/9Ks1YxAE86iz9A0dUiDl"; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,networkforensic.dk; metadata:09122020; classtype:misc-activity; sid:5027484; rev:1;)
#
#
# Bvp47 - a Top-tier Backdoor of US NSA Equation Group - SIGS number range: 5027551 - 50276003
alert tcp $EXTERNAL_NET any -> any 1357 (msg:"NF - APT - US NSA Equation Group - Bvp47 - SYN KNOCK"; flags:S; dsize:136; flowbits:set,NF-Bvp47; flowbits:noalert; reference:url,networkforensic.dk; reference:url,www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group; metadata:23022022; classtype:trojan-activity; sid:5027551; rev:3;)
alert tcp any any -> $EXTERNAL_NET 2468 (msg:"NF - APT - US NSA Equation Group - Bvp47 - Bvp47 backdoor connection established"; flow:established; flowbits:isset,NF-Bvp47; reference:url,networkforensic.dk; reference:url,www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group; metadata:23022022; classtype:trojan-activity; sid:5027552; rev:3;)
alert tcp $EXTERNAL_NET any -> any 1357 (msg:"NF - APT - US NSA Equation Group - Bvp47 - ACK KNOCK"; flags:A; dsize:136; flowbits:set,NF-Bvp47Ack; flowbits:noalert; reference:url,networkforensic.dk; reference:url,www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group; metadata:23022022; classtype:trojan-activity; sid:5027554; rev:2;)
alert tcp any any -> $EXTERNAL_NET 2468 (msg:"NF - APT - US NSA Equation Group - Bvp47 - Bvp47 backdoor connection established"; flow:established; flowbits:isset,NF-Bvp47Ack; reference:url,networkforensic.dk; reference:url,www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group; metadata:23022022; classtype:trojan-activity; sid:5027555; rev:2;)
#
# 
# NF - Sunburst Countermeasures REF: https://github.com/fireeye/sunburst_countermeasures - Copyright 2020 by FireEye, Inc - SIGS number range: 5027601 - 5027650
alert tcp $HOME_NET any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"/swip/Events HTTP/1"; within:100; content:"Host: "; content:!".solarwinds.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027601; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"/swip/upd/SolarWinds.CortexPlugin.Components.xml"; distance:0; content:"Host: "; content:!".solarwinds.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027602; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:".avsvmcloud.com"; distance:0; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027603; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"swip/Upload.ashx HTTP/1"; within:100; content:"Host: "; content:!".solarwinds.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027604; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"/swip/upd/"; within:75; content:" HTTP/1."; distance:0; content:"Host: "; content:!".solarwinds.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027605; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"avsvmcloud.com"; distance:0; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027606; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"|55 04 03|"; distance:0; content:"digitalcollege.org"; within:50; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027607; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"|55 04 03|"; distance:0; content:"freescanonline.com"; within:50; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027608; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"|55 04 03|"; distance:0; content:"deftsecurity.com"; within:50; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027609; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"|55 04 03|"; distance:0; content:"thedoccloud.com"; within:50; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027610; rev:1;)
alert tcp any any <> any 443 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|16 03|"; depth:2; content:"|55 04 03|"; distance:0; content:"virtualdataserver.com"; within:50; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027611; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:"digitalcollege.org"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027612; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:"freescanonline.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027613; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:"deftsecurity.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027614; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:"thedoccloud.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027615; rev:1;)
alert tcp any any -> any any (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"T "; offset:2; depth:3; content:"Host:"; content:"virtualdataserver.com"; within:100; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027616; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"APT.Backdoor.MSIL.SUNBURST"; content:"|00 01 00 00|"; offset:4; depth:4; content:"|0b|appsync-api"; distance:0; content:"|09|"; within:1; content:"-"; distance:2; within:1; content:"st"; distance:2; within:2; content:"|0a|avsvmcloud|03|com"; distance:0; content:!"|00 00 0B 61 70 70 73 79 6E 63 2D 61 70 69|"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027617; rev:1;)
alert tcp $HOME_NET any -> any 443 (msg:"Backdoor.BEACON"; content:"|16 03 03|"; depth:3; content:"incomeupdate.com"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027618; rev:1;)
alert tcp $HOME_NET any -> any 443 (msg:"Backdoor.BEACON"; content:"|16 03 03|"; depth:3; content:"zupertech.com"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027619; rev:1;)
alert tcp $HOME_NET any -> any 443 (msg:"Backdoor.BEACON"; content:"|16 03 03|"; depth:3; content:"databasegalore.com"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027620; rev:1;)
alert tcp $HOME_NET any -> any 443 (msg:"Backdoor.BEACON"; content:"|16 03 03|"; depth:3; content:"panhardware.com"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027621; rev:1;)
alert tcp $HOME_NET any -> any any (msg:"Backdoor.BEACON"; content:"POST"; depth:4; content:"|0d 0a 0d 0a|name=\""; content:"\"\;filename=\""; content:"\"|0a|Content-Type:"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027622; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"Backdoor.BEACON"; content:"HTTP/1."; depth:7; content:"Server: nginx/1.14.0 (Ubuntu)"; distance:0; content:"Connection: close"; distance:0; content:"Cache-Control: max-age=300, must-revalidate"; distance:0; content:"X-Content-Type-Options: nosniff"; distance:0; content:"X-AspNetMvc-Version: 3.0"; distance:0; content:"X-AspNet-Version: 4.0.30319"; distance:0; content:"X-Powered-By: ASP.NET"; distance:0; content:"Content-Length: "; content:"|0d 0a|"; distance:6; within:4; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027623; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"Backdoor.BEACON"; flow:from_server; content:"<title>Woman-Five-How-To-Why-Your-Celebrating-Learn-Brand</title>"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027624; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"Backdoor.BEACON"; flow:from_server; content:"<p>Companies-Best-Man-Vendors-Best</p>"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027625; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"Backdoor.BEACON"; flow:from_server; content:"<meta name=\"msvalidate.01\" content=\"ECEE9516DDABFC7CCBBF1EACC04CAC20\">"; content:"<meta name=\"google-site-verification\" content=\"CD5EF1FCB54FE29C838ABCBBE0FA57AE\">"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027626; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"Backdoor.BEACON"; flow:from_server; content:"<p>Million-Support-Years-Week-Agents</p>"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027627; rev:1;)
alert tcp $HOME_NET any -> any 443 (msg:"Backdoor.BEACON"; content:"|16 03 03|"; depth:3; content:"websitetheme.com"; reference:url,github.com/fireeye/sunburst_countermeasures; reference:url,networkforensic.dk; metadata:17122020; classtype:misc-activity; sid:5027628; rev:1;)
#
#
# NF - Filezilla Server - SIGS number range: 5027701 - 5027710
alert tcp $HOME_NET 14147 -> any 1024: (msg:"NF - FileZilla Server admin interface access - Connection Setup"; flags:PA; content:"|46 5a 53|"; depth:3; content:!"Auth failed"; reference:url,networkforensic.dk; metadata:15072021; classtype:successful-admin; sid:5027701; rev:1;)
alert tcp $HOME_NET 14147 -> any 1024: (msg:"NF - FileZilla Server admin interface access - Auth Failed"; content:"Auth failed"; reference:url,networkforensic.dk; metadata:15072021; classtype:attempted-admin; sid:5027702; rev:1;)
#
#
# NF - Trojan SQUIRRELWAFFLE LOADER - SIGS number range: 5027711 - 5027800
alert tcp $EXTERNAL_NET 80 -> $HOME_NET 1024: (msg:"NF - Trojan SQUIRRELWAFFLE LOADER"; flow:to_client,established; content:"|3d 0a 0a 0a 09 09 09 0d 0d 0d|"; nocase; reference:url,networkforensic.dk; metadata:25092021; classtype:trojan-activity; sid:5027711; rev:1;) 
#
#
# NF - HPE-iLO 4 - SIGS number range: 5027801 - 5027900
alert tcp any $HTTP_PORTS -> any any (msg:"NF - HPE-iLO client connecting to server"; flow:established; content:"303"; http_stat_code; content:"HPE-iLO-Server"; reference:url,networkforensic.dk; metadata:19102021; classtype:misc-activity; sid:5027801; rev:1;)
alert tcp any 443 -> any any (msg:"NF - HPE-iLO - Default certificate";  ssl_state:server_hello; content:"|49 4c 4f|"; content:"Hewlett Packard Enterprise"; reference:url,networkforensic.dk; metadata:19102021; classtype:misc-activity; sid:5027802; rev:1;)
alert tcp any 17990 -> any any (msg:"NF - HPE-iLO - Remote Console activated"; flow:to_client,established; flags:PA; content:"|50|"; depth:1; reference:url,networkforensic.dk; metadata:19102021; classtype:misc-activity; sid:5027803; rev:1;)
#
#
# NF - BIMP-BotNet Attacks - SIGS number range: 5027901 - 5028000
alert tcp $EXTERNAL_NET any -> $HOME_NET [465,993] (msg:"NF - BIMP-BotNet Attacking - Password Attacks - 1"; flow:to_server,established; ssl_state:client_hello; content:"|00 33 00 32 00 31 00 30 00|"; reference:url,networkforensic.dk; reference:url,www.guardicore.com/labs/fritzfrog-a-new-generation-of-peer-to-peer-botnets; metadata:06122021; classtype:attempted-user; sid:5027901; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [465,993] (msg:"NF - BIMP-BotNet Attacking - Password Attacks - 2"; flow:to_server,established; ssl_state:client_hello; content:"|35 00 2f 00 39 00 33 00 3d 00 3c 00 6b 00 67 00 6a|"; reference:url,networkforensic.dk; reference:url,www.guardicore.com/labs/fritzfrog-a-new-generation-of-peer-to-peer-botnets; metadata:21122021; classtype:attempted-user; sid:5027902; rev:2;)
#
#
# NF - Apache log4j - SIGS number range: 5050000 - 5051000
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - log4j - LDAP Bind to External Observed"; flow:established, to_server; dsize:14; content:"|02 01 03 04 00 80 00|"; offset:7; isdataat:!1, relative; threshold:type limit, track by_src, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050000; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - log4j - JRMI Request to External Observed"; flow:established, to_server; dsize:7; content:"JRMI"; depth:4; threshold:type limit, track by_src, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050001; rev:3;)
alert tcp $EXTERNAL_NET !445 -> $HOME_NET any (msg:"NF - log4j - Java class inbound after exploit attempt"; flow:established, to_client; content: "|CA FE BA BE 00 00 00|"; depth:40; fast_pattern; threshold:type limit, track by_dst, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050002; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"NF - log4j - Class Retrieval from External using Java"; flow:established, to_server; content:"GET"; http_method; content:".class"; nocase; http_uri; fast_pattern; content:"Java/"; http_header; threshold:type limit, track by_src, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050003; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - log4j - Possible JNDI LDAP Exploitation Observed"; flow:established, from_server; content:"javaCodeBase|31|"; fast_pattern; content:"http"; distance:3; within:4; threshold:type limit, track by_dst, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050004; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - log4j - DECODE - EXPLOIT - Possible Apache Log4j Exploit Attempt in Basic Auth Header"; flow:established, to_server; content:"Authorization|3a 20|Basic|20|"; http_header; fast_pattern; base64_decode:bytes 200, offset 0, relative; base64_data; content:"${"; content:"}"; distance:0; threshold:type limit, track by_dst, count 1, seconds 3600; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050005; rev:3;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - log4j - STRICT DECODE - Possible Apache Log4j Exploit Attempt in Basic Auth Header (strict)"; flow:established, to_server; content:"Authorization|3a 20|Basic|20|"; http_header; fast_pattern; base64_decode:bytes 200, offset 0, relative; base64_data; content:"${"; content:"}"; distance:0; pcre:"/(\$\{\w+:.*\}|jndi)/Hi"; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050006; rev:3;)
alert tcp any any -> any any (msg: "NF - log4Shell - RCE Attempt ldap"; flow: from_client, established; content:"${jndi:ldap://"; reference:cve,2021-44228; reference:url,falcon.crowdstrike.com/intelligence/reports/CSA-211099; reference:url,networkforensic.dk; metadata:27122021; classtype:web-application-attack; sid:5050007; rev:3;)
alert tcp any any -> any any (msg: "NF - log4Shell - RCE Attempt"; flow: from_server, established; content:"|ca fe ba be 00 00 00|"; reference:cve,2021-44228; reference:url,falcon.crowdstrike.com/intelligence/reports/CSA-211099; reference:url,networkforensic.dk; metadata:27122021; classtype:trojan-activity; sid:5050008; rev:3;)
alert tcp any any -> any any (msg:"NF - log4j - EXPLOIT Apache log4j - Obfuscation used - ::-j"; flow:established; stream_size:client,<,10000; content:"|24 7b|"; content:"|24 7b 3a 3a 2d 6a 7d|"; distance:0; within:320; reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050009; rev:3;)
alert tcp any any -> any any (msg:"NF - log4j - EXPLOIT Apache log4j"; flow:established; stream_size:client,<,10000; content:"|24 7b|"; content:"|6a 6e 64 69 3a|"; distance:0; within:320;  reference:cve,2021-44228; reference:url,networkforensic.dk; metadata:27122021; classtype:attempted-admin; sid:5050010; rev:3;)
#
#
# NF - Pikabot, an emerging malware family - SIGS number range: 5051001 - 5052000
#alert tcp $HOME_NET 1024: -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Possible Trojan PikaBot URL formating  - No Alert"; flow:to_server,established; pcre:"/\/([0-9a-zA-Z]{3,6})\/([0-9a-zA-Z]{5,12})/U"; flowbits:set,NF-Pikabot; flowbits:noalert; reference:url,networkforensic.dk; metadata:26052023; classtype:trojan-activity; sid:5051001; rev:1;)
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"NF - Trojan PikaBot sending DLL file - Check host"; flow:from_server,established; content:"200"; http_stat_code; content:"|21|This program cannot be run in DOS mode|2e|";  flowbits:isset,NF-Pikabot; reference:url,networkforensic.dk; metadata:26052023; classtype:misc-activity; sid:5051002; rev:1;)
#
#
# Chain of events when Zyxel firewall are compromise and joining MooBOT / Mirai -  SIGS number range: 5052001 - 5052500
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - Reverse Shell Without TTY - Outbound"; flow:established,to_server; pcre:"/^(?:ba)?sh/"; content:"|3a 20|no|20|job|20|control|20|in|20|this|20|shell"; fast_pattern; within:30; reference:url,pentestmonkey.net/blog/post-exploitation-without-a-tty; reference:url,networkforensic.dk; metadata:27052023; classtype:successful-admin; sid:5052001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NF - ELF executable download over HTTP"; flow:established, to_client; file_data; content:"|7F 45 4C 46|"; depth:4; content:"|00|"; distance:15; within:16; reference:url,networkforensic.dk; metadata:27052023; classtype:misc-activity; sid:5052002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"NF - HTTP Request to dotted quad for MIPS extn file - Outbound"; flow:established,to_server; content:"GET"; http_method; content:"|2E|mips"; http_uri; fast_pattern; isdataat:!1,relative; content:"|2E|"; pcre:"/Host|3a 20|\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/i"; content:!"Referer|3A|"; http_header; reference:url,networkforensic.dk; metadata:27052023; classtype:misc-activity; sid:5052003; rev:1;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 1024: (msg:"NF - Malware MooBOT / Mirai DDOS Variant - Server Response - No Alert"; flags:PA; dsize:3; content:"|33 66 99|"; flowbits:set,NF-Mirari; flowbits:noalert; reference:url,networkforensic.dk; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en; metadata:24052023; classtype:trojan-activity; sid:5052004; rev:1;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: (msg:"NF - Malware MooBOT / Mirai DDOS Variant - Server Response"; flags:PA; dsize:2; content:"|00 00|"; flowbits:isset,NF-Mirari; reference:url,networkforensic.dk; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en; metadata:24052023; classtype:trojan-activity; sid:5052005; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"NF - Zyxel ZyWALL IKEv2 IPSec VPN Remote Command Execution Attempt - Inbound"; content:"|29 20 22|"; fast_pattern; offset:16; byte_test:2, >, 48, 12, relative; content:"|00 0E|"; distance:14; within:5; reference:url,networkforensic.dk; reference:url,github.com/BenHays142/CVE-2023-28771-PoC; reference:cve,CVE-2023-28771; metadata:29052023; classtype:attempted-admin; sid:5052006; rev:1;)
#
#
# MQTT connection from inside to ouside broker - SIGS number range: 5052501 - 5052600
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1883 (msg:"NF - MQTT connect command from inside to outside"; flags:PA; content:"|4d 51 49 73 64 70|"; flowbits:set,NF-MQTT_Connect; flowbits:noalert; reference:url,networkforensic.dk; metadata:06062023; classtype:misc-activity; sid:5052501; rev:1;)
alert tcp $EXTERNAL_NET 1883 -> $HOME_NET any (msg:"NF - MQTT connect ACK from MQTT Broker - MQTT Connection accepted - MQTT Running unencrypted"; flags:PA; content:"|20 02 00 00|"; flowbits:isset,NF-MQTT_Connect; reference:url,networkforensic.dk; metadata:06062023; classtype:misc-activity; sid:5052502; rev:1;)
#
#
# Trojan Formbook -  SIGS number range: 5052601 - 5052700
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 80 (msg:"NF - Trojan.Fomrbook GET request URI form - NO Alert"; flow:to_server,established; content:"GET"; http_method; pcre:"/\/[a-zA-Z0-9]{4}\/?/iU"; content:"Connection: close"; flowbits:set,NF-formbook; flowbits:noalert; reference:url,networkforensic.dk; metadata:27062023; classtype:misc-activity; sid:5052601; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $EXTERNAL_NET 1024: (msg:"NF - Trojan.Fomrbook server C2 response to Clients GET request"; flow:to_client,established; content:"Connection: close"; flowbits:isset,NF-formbook; reference:url,networkforensic.dk; metadata:27062023; classtype:misc-activity; sid:5052602; rev:1;)
#
#
# MQTT protocol -  SIGS number range: 5052701 - 5052800
alert tcp any 1024: -> any 1883 (msg:"NF - MQTT connect command from inside to outside"; flags:PA; content:"|4d 51|"; flowbits:set,NF-MQTT_Connect; flowbits:noalert; reference:url,networkforensic.dk; metadata:06062023; classtype:misc-activity; sid:5052701; rev:1;)
alert tcp any 1883 -> any any (msg:"NF - MQTT connect ACK from MQTT Broker - MQTT Connection accepted - MQTT Running unencrypted"; flags:PA; content:"|20 02 00 00|"; flowbits:isset,NF-MQTT_Connect; reference:url,networkforensic.dk; metadata:06062023; classtype:policy-violation; sid:5052702; rev:1;)
#
alert tcp any 1024: -> any 1883 (msg:"NF - MQTT connect command"; flags:PA; content:"|4d 51|"; flowbits:set,NF-MQTT_Connect2; flowbits:noalert; reference:url,networkforensic.dk; metadata:06122023; classtype:misc-activity; sid:5052703; rev:1;)
alert tcp any 1883 -> any any (msg:"NF - MQTT Connection Refused - Could be bruteforce attack"; flags:PA; content:"|20 02 00 05|"; detection_filter:track by_src, count 20, seconds 5; flowbits:isset,NF-MQTT_Connect2; reference:url,networkforensic.dk; metadata:06122023; classtype:attempted-user; sid:5052704; rev:1;)
#
alert tcp any 1024: -> any 1883 (msg:"NF - MQTT connect command with username and password in the clear"; flow:established, to_server; flags:PA; content:"|4d 51|"; offset:4; depth:2; content:"|c2|"; distance:3; within:4; reference:url,networkforensic.dk; metadata:06122023; classtype:policy-violation; sid:5052705; rev:1;)
alert tcp any 1024: -> any 1883 (msg:"NF - APT - Mustang Panda on MQTT C&C"; flow:established, to_server; flags:PA; content:"|69 6f 74 2f 73 65 72 76 65 72 32|"; reference:url,networkforensic.dk; metadata:05092023;classtype:trojan-activity; sid:5052706; rev:1;)
#
#
# END